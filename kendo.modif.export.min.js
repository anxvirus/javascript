!function(e, t) {
  t("kendo.ooxml.min", ["kendo.core.min"], e)
}(function() {
  return function(e, t) {
    function n(e) {
      var t = Math.floor(e / 26) - 1;
      return(t >= 0 ? n(t) : "") + String.fromCharCode(65 + e % 26)
    }
    function r(e, t) {
      return n(t) + (e + 1)
    }
    function i(e, t) {
      return n(t) + "$" + (e + 1)
    }
    function s(e) {
      var t = e.frozenRows || (e.freezePane || {}).rowSplit || 1;
      return t - 1
    }
    function o(e) {
      return(e / 7 * 100 + .5) / 100
    }
    function a(e) {
      return.75 * e
    }
    function l(e) {
      return 6 > e.length && (e = e.replace(/(\w)/g, function(e, t) {
        return t + t
      })), e = e.substring(1).toUpperCase(), 8 > e.length && (e = "FF" + e), e
    }
    function d(e) {
      var t = "thin";
      return 2 === e ? t = "medium" : 3 === e && (t = "thick"), t
    }
    function u(e, t) {
      var n = "";
      return t && t.size && (n += "<" + e + ' style="' + d(t.size) + '">', t.color && (n += '<color rgb="' + l(t.color) + '"/>'), n += "</" + e + ">"), n
    }
    function c(e) {
      return"<border>" + u("left", e.left) + u("right", e.right) + u("top", e.top) + u("bottom", e.bottom) + "</border>"
    }
    var m = '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>', h = t.template('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><dc:creator>${creator}</dc:creator><cp:lastModifiedBy>${lastModifiedBy}</cp:lastModifiedBy><dcterms:created xsi:type="dcterms:W3CDTF">${created}</dcterms:created><dcterms:modified xsi:type="dcterms:W3CDTF">${modified}</dcterms:modified></cp:coreProperties>'), p = t.template('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"><Application>Microsoft Excel</Application><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size="2" baseType="variant"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>${sheets.length}</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size="${sheets.length}" baseType="lpstr"># for (var idx = 0; idx < sheets.length; idx++) { ## if (sheets[idx].options.title) { #<vt:lpstr>${sheets[idx].options.title}</vt:lpstr># } else { #<vt:lpstr>Sheet${idx+1}</vt:lpstr># } ## } #</vt:vector></TitlesOfParts><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>14.0300</AppVersion></Properties>'), f = t.template('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Default Extension="xml" ContentType="application/xml" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/><Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/># for (var idx = 1; idx <= count; idx++) { #<Override PartName="/xl/worksheets/sheet${idx}.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" /># } #<Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml" /><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml" /></Types>'), g = t.template('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="9303" /><workbookPr defaultThemeVersion="124226" /><bookViews><workbookView xWindow="240" yWindow="45" windowWidth="18195" windowHeight="7995" /></bookViews><sheets># for (var idx = 0; idx < sheets.length; idx++) { ## var options = sheets[idx].options; ## var name = options.name || options.title ## if (name) { #<sheet name="${name}" sheetId="${idx+1}" r:id="rId${idx+1}" /># } else { #<sheet name="Sheet${idx+1}" sheetId="${idx+1}" r:id="rId${idx+1}" /># } ## } #</sheets># if (definedNames.length) { #<definedNames> # for (var di = 0; di < definedNames.length; di++) { #<definedName name="_xlnm._FilterDatabase" hidden="1" localSheetId="${definedNames[di].localSheetId}">${definedNames[di].name}!$${definedNames[di].from}:$${definedNames[di].to}</definedName> # } #</definedNames># } #<calcPr calcId="145621" /></workbook>'), x = t.template('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" mc:Ignorable="x14ac"><dimension ref="A1" /><sheetViews><sheetView #if(index==0) {# tabSelected="1" #}# workbookViewId="0"># if (frozenRows || frozenColumns) { #<pane state="frozen"# if (frozenColumns) { # xSplit="${frozenColumns}"# } ## if (frozenRows) { # ySplit="${frozenRows}"# } # topLeftCell="${String.fromCharCode(65 + (frozenColumns || 0))}${(frozenRows || 0)+1}"/># } #</sheetView></sheetViews><sheetFormatPr x14ac:dyDescent="0.25" defaultRowHeight="#= defaults.rowHeight ? defaults.rowHeight * 0.75 : 15 #" # if (defaults.columnWidth) { # defaultColWidth="#= kendo.ooxml.toWidth(defaults.columnWidth) #" # } # /># if (columns && columns.length > 0) { #<cols># for (var ci = 0; ci < columns.length; ci++) { ## var column = columns[ci]; ## var columnIndex = typeof column.index === "number" ? column.index + 1 : (ci + 1); ## if (column.width) { #<col min="${columnIndex}" max="${columnIndex}" customWidth="1"# if (column.autoWidth) { # width="${((column.width*7+5)/7*256)/256}" bestFit="1"# } else { # width="#= kendo.ooxml.toWidth(column.width) #" # } #/># } ## } #</cols># } #<sheetData># for (var ri = 0; ri < data.length; ri++) { ## var row = data[ri]; ## var rowIndex = typeof row.index === "number" ? row.index + 1 : (ri + 1); #<row r="${rowIndex}" x14ac:dyDescent="0.25" # if (row.height) { # ht="#= kendo.ooxml.toHeight(row.height) #" customHeight="1" # } # ># for (var ci = 0; ci < row.data.length; ci++) { ## var cell = row.data[ci];#<c r="#=cell.ref#"# if (cell.style) { # s="#=cell.style#" # } ## if (cell.type) { # t="#=cell.type#"# } #># if (cell.formula != null) { #<f>${cell.formula}</f># } ## if (cell.value != null) { #<v>${cell.value}</v># } #</c># } #</row># } #</sheetData># if (filter) { #<autoFilter ref="${filter.from}:${filter.to}"/># } ## if (mergeCells.length) { #<mergeCells count="${mergeCells.length}"># for (var ci = 0; ci < mergeCells.length; ci++) { #<mergeCell ref="${mergeCells[ci]}"/># } #</mergeCells># } #<pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3" /></worksheet>'), v = t.template('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"># for (var idx = 1; idx <= count; idx++) { #<Relationship Id="rId${idx}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet${idx}.xml" /># } #<Relationship Id="rId${count+1}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml" /><Relationship Id="rId${count+2}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml" /></Relationships>'), _ = t.template('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="${count}" uniqueCount="${uniqueCount}"># for (var index in indexes) { #<si><t>${index.substring(1)}</t></si># } #</sst>'), b = t.template('<?xml version="1.0" encoding="UTF-8"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><numFmts count="${formats.length}"># for (var fi = 0; fi < formats.length; fi++) { ## var format = formats[fi]; #<numFmt formatCode="${format.format}" numFmtId="${165+fi}" /># } #</numFmts><fonts count="${fonts.length+1}" x14ac:knownFonts="1"><font><sz val="11" /><color theme="1" /><name val="Calibri" /><family val="2" /><scheme val="minor" /></font># for (var fi = 0; fi < fonts.length; fi++) { ## var font = fonts[fi]; #<font># if (font.fontSize) { #<sz val="${font.fontSize}" /># } else { #<sz val="11" /># } ## if (font.bold) { #<b/># } ## if (font.italic) { #<i/># } ## if (font.underline) { #<u/># } ## if (font.color) { #<color rgb="${font.color}" /># } else { #<color theme="1" /># } ## if (font.fontFamily) { #<name val="${font.fontFamily}" /><family val="2" /># } else { #<name val="Calibri" /><family val="2" /><scheme val="minor" /># } #</font># } #</fonts><fills count="${fills.length+2}"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill># for (var fi = 0; fi < fills.length; fi++) { ## var fill = fills[fi]; ## if (fill.background) { #<fill><patternFill patternType="solid"><fgColor rgb="${fill.background}"/></patternFill></fill># } ## } #</fills><borders count="${borders.length+1}"><border><left/><right/><top/><bottom/><diagonal/></border># for (var bi = 0; bi < borders.length; bi++) { ##= kendo.ooxml.borderTemplate(borders[bi]) ## } #</borders><cellStyleXfs count="1"><xf borderId="0" fillId="0" fontId="0" /></cellStyleXfs><cellXfs count="${styles.length+1}"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0"/># for (var si = 0; si < styles.length; si++) { ## var style = styles[si]; #<xf xfId="0"# if (style.fontId) { # fontId="${style.fontId}" applyFont="1"# } ## if (style.fillId) { # fillId="${style.fillId}" applyFill="1"# } ## if (style.numFmtId) { # numFmtId="${style.numFmtId}" applyNumberFormat="1"# } ## if (style.textAlign || style.verticalAlign || style.wrap) { # applyAlignment="1"# } ## if (style.borderId) { # borderId="${style.borderId}" applyBorder="1"# } #># if (style.textAlign || style.verticalAlign || style.wrap) { #<alignment# if (style.textAlign) { # horizontal="${style.textAlign}"# } ## if (style.verticalAlign) { # vertical="${style.verticalAlign}"# } ## if (style.wrap) { # wrapText="1"# } #/># } #</xf># } #</cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles><dxfs count="0" /><tableStyles count="0" defaultTableStyle="TableStyleMedium2" defaultPivotStyle="PivotStyleMedium9" /></styleSheet>'), w = new Date(1900, 0, 0), y = t.Class.extend({init: function(e, t, n, r) {
        this.options = e, this._strings = t, this._styles = n, this._borders = r
      }, toXML: function(e) {
        var t, n, i, o, a, l;
        for (this._mergeCells = this.options.mergedCells || [], this._rowsByIndex = [], t = this.options.rows || [], n = 0; t.length > n; n++)
          i = t[n].index, "number" != typeof i && (i = n), t[n].index = i, this._rowsByIndex[i] = t[n];
        for (o = [], n = 0; t.length > n; n++)
          o.push(this._row(t[n], n));
        return o.sort(function(e, t) {
          return e.index - t.index
        }), a = this.options.filter, a && "number" == typeof a.from && "number" == typeof a.to && (a = {from: r(s(this.options), a.from), to: r(s(this.options), a.to)}), l = this.options.freezePane || {}, x({frozenColumns: this.options.frozenColumns || l.colSplit, frozenRows: this.options.frozenRows || l.rowSplit, columns: this.options.columns, defaults: this.options.defaults || {}, data: o, index: e, mergeCells: this._mergeCells, filter: a})
      }, _row: function(t) {
        var n = [], r = 0, i = this, s = {};
        return e.each(t.cells, function(o, a) {
          var l, d;
          a && ("number" == typeof a.index ? (l = a.index, r = l - o) : l = o + r, a.colSpan && (r += a.colSpan - 1), d = i._cell(a, t.index, l), e.each(d, function(e, t) {
            s[t.ref] || (s[t.ref] = !0, n.push(t))
          }))
        }), {data: n, height: t.height, index: t.index}
      }, _lookupString: function(e) {
        var t = "$" + e, n = this._strings.indexes[t];
        return void 0 !== n ? e = n : (e = this._strings.indexes[t] = this._strings.uniqueCount, this._strings.uniqueCount++), this._strings.count++, e
      }, _lookupStyle: function(n) {
        var r, i = t.stringify(n);
        return"{}" == i ? 0 : (r = e.inArray(i, this._styles), 0 > r && (r = this._styles.push(i) - 1), r + 1)
      }, _lookupBorder: function(n) {
        var r, i = t.stringify(n);
        return"{}" != i ? (r = e.inArray(i, this._borders), 0 > r && (r = this._borders.push(i) - 1), r + 1) : void 0
      }, _cell: function(e, n, i) {
        var s, o, a, l, d, u, c, m, h, p, f, g, x, v;
        if (!e)
          return[];
        if (s = e.value, o = {}, e.borderLeft && (o.left = e.borderLeft), e.borderRight && (o.right = e.borderRight), e.borderTop && (o.top = e.borderTop), e.borderBottom && (o.bottom = e.borderBottom), o = this._lookupBorder(o), a = {bold: e.bold, color: e.color, background: e.background, italic: e.italic, underline: e.underline, fontFamily: e.fontFamily || e.fontName, fontSize: e.fontSize, format: e.format, textAlign: e.textAlign || e.hAlign, verticalAlign: e.verticalAlign || e.vAlign, wrap: e.wrap, borderId: o}, l = this.options.columns || [], d = l[i], u = typeof s, d && d.autoWidth && (c = s, "number" === u && (c = t.toString(s, e.format)), d.width = Math.max(d.width || 0, (c + "").length)), "string" === u ? (s = this._lookupString(s), u = "s") : "number" === u ? u = "n" : "boolean" === u ? (u = "b", s = +s) : s && s.getTime ? (u = null, m = (s.getTimezoneOffset() - w.getTimezoneOffset()) * t.date.MS_PER_MINUTE, s = (s - w - m) / t.date.MS_PER_DAY + 1, a.format || (a.format = "mm-dd-yy")) : (u = null, s = null), a = this._lookupStyle(a), h = [], p = r(n, i), h.push({value: s, formula: e.formula, type: u, style: a, ref: p}), f = e.colSpan || 1, g = e.rowSpan || 1, f > 1 || g > 1) {
          for (this._mergeCells.push(p + ":" + r(n + g - 1, i + f - 1)), v = n + 1; n + g > v; v++)
            for (this._rowsByIndex[v] || (this._rowsByIndex[v] = {index:v, cells:[]}), x = i; i + f > x; x++)
              this._rowsByIndex[v].cells.splice(x, 0, {});
          for (x = i + 1; i + f > x; x++)
            h.push({ref: r(n, x)})
        }
        return h
      }}), k = {General: 0, 0: 1, "0.00": 2, "#,##0": 3, "#,##0.00": 4, "0%": 9, "0.00%": 10, "0.00E+00": 11, "# ?/?": 12, "# ??/??": 13, "mm-dd-yy": 14, "d-mmm-yy": 15, "d-mmm": 16, "mmm-yy": 17, "h:mm AM/PM": 18, "h:mm:ss AM/PM": 19, "h:mm": 20, "h:mm:ss": 21, "m/d/yy h:mm": 22, "#,##0 ;(#,##0)": 37, "#,##0 ;[Red](#,##0)": 38, "#,##0.00;(#,##0.00)": 39, "#,##0.00;[Red](#,##0.00)": 40, "mm:ss": 45, "[h]:mm:ss": 46, "mmss.0": 47, "##0.0E+0": 48, "@": 49, "[$-404]e/m/d": 27, "m/d/yy": 30, t0: 59, "t0.00": 60, "t#,##0": 61, "t#,##0.00": 62, "t0%": 67, "t0.00%": 68, "t# ?/?": 69, "t# ??/??": 70}, S = t.Class.extend({init: function(t) {
        this.options = t || {}, this._strings = {indexes: {}, count: 0, uniqueCount: 0}, this._styles = [], this._borders = [], this._sheets = e.map(this.options.sheets || [], e.proxy(function(e) {
          return e.defaults = this.options, new y(e, this._strings, this._styles, this._borders)
        }, this))
      }, toDataURL: function() {
        var n, r, o, a, d, u, c, x, w, y, S, T, C, I;
        if ("undefined" == typeof JSZip)
          throw Error("JSZip not found. Check http://docs.telerik.com/kendo-ui/framework/excel/introduction#requirements for more details.");
        for (n = new JSZip, r = n.folder("docProps"), r.file("core.xml", h({creator:this.options.creator || "Kendo UI", lastModifiedBy:this.options.creator || "Kendo UI", created:this.options.date || (new Date).toJSON(), modified:this.options.date || (new Date).toJSON()})), o = this._sheets.length, r.file("app.xml", p({sheets:this._sheets})), a = n.folder("_rels"), a.file(".rels", m), d = n.folder("xl"), u = d.folder("_rels"), u.file("workbook.xml.rels", v({count:o})), d.file("workbook.xml", g({sheets:this._sheets, definedNames:e.map(this._sheets, function(e, t) {
          var n = e.options, r = n.filter;
          return r && void 0 !== r.from && void 0 !== r.to ? {localSheetId: t, name: n.name || n.title || "Sheet" + (t + 1), from: i(s(n), r.from), to: i(s(n), r.to)} : void 0
        })})), c = d.folder("worksheets"), x = 0; o > x; x++)
          c.file(t.format("sheet{0}.xml", x + 1), this._sheets[x].toXML(x));
        return w = e.map(this._borders, e.parseJSON), y = e.map(this._styles, e.parseJSON), S = function(e) {
          return e.underline || e.bold || e.italic || e.color || e.fontFamily || e.fontSize
        }, T = e.map(y, function(e) {
          return e.color && (e.color = l(e.color)), S(e) ? e : void 0
        }), C = e.map(y, function(e) {
          return e.format && void 0 === k[e.format] ? e : void 0
        }), I = e.map(y, function(e) {
          return e.background ? (e.background = l(e.background), e) : void 0
        }), d.file("styles.xml", b({fonts: T, fills: I, formats: C, borders: w, styles: e.map(y, function(t) {
            var n = {};
            return S(t) && (n.fontId = e.inArray(t, T) + 1), t.background && (n.fillId = e.inArray(t, I) + 2), n.textAlign = t.textAlign, n.verticalAlign = t.verticalAlign, n.wrap = t.wrap, n.borderId = t.borderId, t.format && (n.numFmtId = void 0 !== k[t.format] ? k[t.format] : 165 + e.inArray(t, C)), n
          })})), d.file("sharedStrings.xml", _(this._strings)), n.file("[Content_Types].xml", f({count: o})), "data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64," + n.generate({compression: "DEFLATE"})
      }});
    t.ooxml = {Workbook: S, Worksheet: y, toWidth: o, toHeight: a, borderTemplate: c}
  }(kendo.jQuery, kendo), kendo
}, "function" == typeof define && define.amd ? define : function(e, t, n) {
  (n || t)()
}), function(e, t) {
  t("editor/main.min", ["util/undoredostack.min", "kendo.combobox.min", "kendo.dropdownlist.min", "kendo.window.min", "kendo.colorpicker.min"], e)
}(function() {
  !function(e, t) {
    var n, r, i, s, o = window.kendo, a = o.Class, l = o.ui.Widget, d = o.support.mobileOS, u = o.support.browser, c = e.extend, m = e.proxy, h = o.deepExtend, p = o.keys, f = a.extend({init: function(e) {
        this.options = e
      }, getHtml: function() {
        var e = this.options;
        return o.template(e.template, {useWithBlock: !1})(e)
      }}), g = {editorWrapperTemplate: '<table cellspacing="4" cellpadding="0" class="k-widget k-editor k-header" role="presentation"><tbody><tr role="presentation"><td class="k-editor-toolbar-wrap" role="presentation"><ul class="k-editor-toolbar" role="toolbar" /></td></tr><tr><td class="k-editable-area" /></tr></tbody></table>', buttonTemplate: '<a href="" role="button" class="k-tool"#= data.popup ? " data-popup" : "" # unselectable="on" title="#= data.title #"><span unselectable="on" class="k-tool-icon #= data.cssClass #"></span><span class="k-tool-text">#= data.title #</span></a>', colorPickerTemplate: '<div class="k-colorpicker #= data.cssClass #" />', comboBoxTemplate: '<select title="#= data.title #" class="#= data.cssClass #" />', dropDownListTemplate: '<span class="k-editor-dropdown"><select title="#= data.title #" class="#= data.cssClass #" /></span>', separatorTemplate: '<span class="k-separator" />', overflowAnchorTemplate: '<a href="" role="button" class="k-tool k-overflow-anchor" data-popup unselectable="on"><span unselectable="on" class="k-icon k-i-more"></span></a>', formatByName: function(t, n) {
        for (var r = 0; n.length > r; r++)
          if (e.inArray(t, n[r].tags) >= 0)
            return n[r]
      }, registerTool: function(e, t) {
        var n = t.options;
        n && n.template && (n.template.options.cssClass = "k-" + e), t.name || (t.options.name = e, t.name = e.toLowerCase()), b.defaultTools[e] = t
      }, registerFormat: function(e, t) {
        b.fn.options.formats[e] = t
      }}, x = {bold: "Bold", italic: "Italic", underline: "Underline", strikethrough: "Strikethrough", superscript: "Superscript", subscript: "Subscript", justifyCenter: "Center text", justifyLeft: "Align text left", justifyRight: "Align text right", justifyFull: "Justify", insertUnorderedList: "Insert unordered list", insertOrderedList: "Insert ordered list", indent: "Indent", outdent: "Outdent", createLink: "Insert hyperlink", unlink: "Remove hyperlink", insertImage: "Insert image", insertFile: "Insert file", insertHtml: "Insert HTML", viewHtml: "View HTML", fontName: "Select font family", fontNameInherit: "(inherited font)", fontSize: "Select font size", fontSizeInherit: "(inherited size)", formatBlock: "Format", formatting: "Format", foreColor: "Color", backColor: "Background color", style: "Styles", emptyFolder: "Empty Folder", editAreaTitle: "Editable area. Press F10 for toolbar.", uploadFile: "Upload", orderBy: "Arrange by:", orderBySize: "Size", orderByName: "Name", invalidFileType: 'The selected file "{0}" is not valid. Supported file types are {1}.', deleteFile: 'Are you sure you want to delete "{0}"?', overwriteFile: 'A file with name "{0}" already exists in the current directory. Do you want to overwrite it?', directoryNotFound: "A directory with this name was not found.", imageWebAddress: "Web address", imageAltText: "Alternate text", imageWidth: "Width (px)", imageHeight: "Height (px)", fileWebAddress: "Web address", fileTitle: "Title", linkWebAddress: "Web address", linkText: "Text", linkToolTip: "ToolTip", linkOpenInNewWindow: "Open link in new window", dialogUpdate: "Update", dialogInsert: "Insert", dialogCancel: "Cancel", createTable: "Create table", createTableHint: "Create a {0} x {1} table", addColumnLeft: "Add column on the left", addColumnRight: "Add column on the right", addRowAbove: "Add row above", addRowBelow: "Add row below", deleteRow: "Delete row", deleteColumn: "Delete column"}, v = !d || d.ios && d.flatVersion >= 500 || !d.ios && t !== document.documentElement.contentEditable, _ = {basic: ["bold", "italic", "underline"], alignment: ["justifyLeft", "justifyCenter", "justifyRight"], lists: ["insertUnorderedList", "insertOrderedList"], indenting: ["indent", "outdent"], links: ["createLink", "unlink"], tables: ["createTable", "addColumnLeft", "addColumnRight", "addRowAbove", "addRowBelow", "deleteRow", "deleteColumn"]}, b = l.extend({init: function(n, r) {
        var i, s, a, d, u, p = this, f = o.ui.editor, g = f.Dom;
        v && (l.fn.init.call(p, n, r), p.options = h({}, p.options, r), p.options.tools = p.options.tools.slice(), n = p.element, u = n[0], d = g.name(u), this._registerHandler(n.closest("form"), "submit", m(p.update, p, t)), a = c({}, p.options), a.editor = p, "textarea" == d ? (p._wrapTextarea(), s = p.wrapper.find(".k-editor-toolbar"), u.id && s.attr("aria-controls", u.id)) : (p.element.attr("contenteditable", !0).addClass("k-widget k-editor k-editor-inline"), a.popup = !0, s = e('<ul class="k-editor-toolbar" role="toolbar" />').insertBefore(n)), p.toolbar = new f.Toolbar(s[0], a), p.toolbar.bindTo(p), "textarea" == d && setTimeout(function() {
          var e = p.wrapper[0].style.height, t = parseInt(e, 10), n = p.wrapper.height();
          e.indexOf("px") > 0 && !isNaN(t) && n > t && p.wrapper.height(t - (n - t))
        }), p._resizable(), p._initializeContentElement(p), p.keyboard = new f.Keyboard([new f.BackspaceHandler(p), new f.TypingHandler(p), new f.SystemHandler(p)]), p.clipboard = new f.Clipboard(this), p.undoRedoStack = new o.util.UndoRedoStack, r && r.value ? i = r.value : p.textarea ? (i = u.value, p.options.encoded && e.trim(u.defaultValue).length && (i = u.defaultValue), i = i.replace(/[\r\n\v\f\t ]+/gi, " ")) : i = u.innerHTML, p.value(i || o.ui.editor.emptyElementContent), this._registerHandler(document, {mousedown: function() {
            p._endTyping()
          }, mouseup: function() {
            p._mouseup()
          }}), p.toolbar.resize(), o.notify(p))
      }, _endTyping: function() {
        var e = this.keyboard;
        try {
          e.isTypingInProgress() && (e.endTyping(!0), this.saveSelection())
        } catch (t) {
        }
      }, _selectionChange: function() {
        u.msie || o.ui.editor.Dom.ensureTrailingBreaks(this.body), this._selectionStarted = !1, this.saveSelection(), this.trigger("select", {})
      }, _resizable: function() {
        var n = this.options.resizable, r = e.isPlainObject(n) ? n.content === t || n.content === !0 : n;
        r && this.textarea && (e("<div class='k-resize-handle'><span class='k-icon k-resize-se' /></div>").insertAfter(this.textarea), this.wrapper.kendoResizable(c({}, this.options.resizable, {start: function(t) {
            var n = this.editor = e(t.currentTarget).closest(".k-editor");
            this.initialSize = n.height(), n.find("td:last").append("<div class='k-overlay' />")
          }, resize: function(e) {
            var t = e.y.initialDelta, n = this.initialSize + t, r = this.options.min || 0, i = this.options.max || 1 / 0;
            n = Math.min(i, Math.max(r, n)), this.editor.height(n)
          }, resizeend: function() {
            this.editor.find(".k-overlay").remove(), this.editor = null
          }})))
      }, _wrapTextarea: function() {
        var t = this, n = t.element, r = n[0].style.width, i = n[0].style.height, s = g.editorWrapperTemplate, o = e(s).insertBefore(n).width(r).height(i), a = o.find(".k-editable-area");
        n.attr("autocomplete", "off").appendTo(a).addClass("k-content k-raw-content").css("display", "none"), t.textarea = n, t.wrapper = o
      }, _createContentElement: function(t) {
        var n, r, i, s = this, a = s.textarea, l = s.options.domain, d = l || document.domain, u = "", c = 'javascript:""';
        return(l || d != location.hostname) && (u = '<script>document.domain="' + d + '"</script>', c = "javascript:document.write('" + u + "')"), a.hide(), n = e("<iframe />", {title: s.options.messages.editAreaTitle, frameBorder: "1"})[0], e(n).css("display", "").addClass("k-content").attr("tabindex", a[0].tabIndex).insertBefore(a), n.src = c, r = n.contentWindow || n, i = r.document || n.contentDocument, e(n).one("load", function() {
          s.toolbar.decorateFrom(i.body)
        }), i.open(), i.write("<!DOCTYPE html><html><head><meta charset='utf-8' /><style>html,body{padding:0;margin:0;height:100%;min-height:100%;}body{font-size:12px;font-family:Verdana,Geneva,sans-serif;margin-top:-1px;padding:1px .2em 0;word-wrap: break-word;-webkit-nbsp-mode: space;-webkit-line-break: after-white-space;" + (o.support.isRtl(a) ? "direction:rtl;" : "") + "}h1{font-size:2em;margin:.67em 0}h2{font-size:1.5em}h3{font-size:1.16em}h4{font-size:1em}h5{font-size:.83em}h6{font-size:.7em}p{margin:0 0 1em;}.k-marker{display:none;}.k-paste-container,.Apple-style-span{position:absolute;left:-10000px;width:1px;height:1px;overflow:hidden}ul,ol{padding-left:2.5em}span{-ms-high-contrast-adjust:none;}a{color:#00a}code{font-size:1.23em}telerik\\3Ascript{display: none;}.k-table{table-layout:fixed;width:100%;border-spacing:0;margin: 0 0 1em;}.k-table td{min-width:1px;padding:.2em .3em;}.k-table,.k-table td{outline:1px;border: 1px dotted #ccc;}.k-table p{margin:0;padding:0;}k\\:script{display:none;}</style>" + u + "<script>(function(d,c){d[c]('header'),d[c]('article'),d[c]('nav'),d[c]('section'),d[c]('footer');})(document, 'createElement');</script>" + e.map(t, function(e) {
          return"<link rel='stylesheet' href='" + e + "'>"
        }).join("") + "</head><body autocorrect='off' contenteditable='true'></body></html>"), i.close(), r
      }, _blur: function() {
        var e = this.textarea, t = e ? e.val() : this._oldValue, n = this.options.encoded ? this.encodedValue() : this.value();
        this.update(), e && e.trigger("blur"), n != t && this.trigger("change")
      }, _spellCorrect: function(e) {
        var n, r = !1;
        this._registerHandler(e.body, {contextmenu: function() {
            e.one("select", function() {
              n = null
            }), e._spellCorrectTimeout = setTimeout(function() {
              n = new o.ui.editor.RestorePoint(e.getRange()), r = !1
            }, 10)
          }, input: function() {
            return n ? o.support.browser.mozilla && !r ? (r = !0, t) : (o.ui.editor._finishUpdate(e, n), t) : t
          }})
      }, _registerHandler: function(t, n, r) {
        if (t = e(t), this._handlers || (this._handlers = []), t.length)
          if (e.isPlainObject(n))
            for (var i in n)
              n.hasOwnProperty(i) && this._registerHandler(t, i, n[i]);
          else
            this._handlers.push({element: t, type: n, handler: r}), t.on(n, r)
      }, _deregisterHandlers: function() {
        var e, t, n = this._handlers;
        for (e = 0; n.length > e; e++)
          t = n[e], t.element.off(t.type, t.handler);
        this._handlers = []
      }, _initializeContentElement: function() {
        var n, r, i = this;
        i.textarea ? (i.window = i._createContentElement(i.options.stylesheets), n = i.document = i.window.contentDocument || i.window.document, i.body = n.body, r = i.window, this._registerHandler(n, "mouseup", m(this._mouseup, this))) : (i.window = window, n = i.document = document, i.body = i.element[0], r = i.body, i.toolbar.decorateFrom(i.body)), this._registerHandler(r, "blur", m(this._blur, this));
        try {
          n.execCommand("enableInlineTableEditing", null, !1)
        } catch (s) {
        }
        o.support.touch && this._registerHandler(n, {selectionchange: m(this._selectionChange, this), keydown: function() {
            o._activeElement() != n.body && i.window.focus()
          }}), this._spellCorrect(i), this._registerHandler(i.body, {dragstart: function(e) {
            e.preventDefault()
          }, keydown: function(e) {
            var n, r, s, o, a, l;
            return e.keyCode !== p.BACKSPACE && e.keyCode !== p.DELETE || "true" === i.body.getAttribute("contenteditable") ? e.keyCode === p.F10 ? (setTimeout(m(i.toolbar.focus, i.toolbar), 100), e.preventDefault(), t) : ((e.keyCode == p.LEFT || e.keyCode == p.RIGHT) && (n = i.getRange(), r = e.keyCode == p.LEFT, s = n[r ? "startContainer" : "endContainer"], o = n[r ? "startOffset" : "endOffset"], a = r ? -1 : 1, r && (o -= 1), o + a > 0 && 3 == s.nodeType && "\ufeff" == s.nodeValue[o] && (n.setStart(s, o + a), n.collapse(!0), i.selectRange(n))), (l = i.keyboard.toolFromShortcut(i.toolbar.tools, e)) ? (e.preventDefault(), /^(undo|redo)$/.test(l) || i.keyboard.endTyping(!0), i.trigger("keydown", e), i.exec(l), !1) : (i.keyboard.clearTimeout(), i.keyboard.keydown(e), t)) : !1
          }, keyup: function(t) {
            var n = [8, 9, 33, 34, 35, 36, 37, 38, 39, 40, 40, 45, 46];
            (e.inArray(t.keyCode, n) > -1 || 65 == t.keyCode && t.ctrlKey && !t.altKey && !t.shiftKey) && i._selectionChange(), i.keyboard.keyup(t)
          }, mousedown: function(t) {
            if (i._selectionStarted = !0, !u.gecko) {
              var n = e(t.target);
              (2 == t.which || 1 == t.which && t.ctrlKey) && n.is("a[href]") && window.open(n.attr("href"), "_new")
            }
          }, click: function(e) {
            var t, n = o.ui.editor.Dom;
            "img" === n.name(e.target) && (t = i.createRange(), t.selectNode(e.target), i.selectRange(t))
          }, "cut copy paste": function(e) {
            i.clipboard["on" + e.type](e)
          }, focusin: function() {
            i.body.hasAttribute("contenteditable") && (e(this).addClass("k-state-active"), i.toolbar.show())
          }, focusout: function() {
            setTimeout(function() {
              var t = o._activeElement(), n = i.body, r = i.toolbar;
              t == n || e.contains(n, t) || e(t).is(".k-editortoolbar-dragHandle") || r.focused() || (e(n).removeClass("k-state-active"), r.hide())
            }, 10)
          }})
      }, _mouseup: function() {
        var e = this;
        e._selectionStarted && setTimeout(function() {
          e._selectionChange()
        }, 1)
      }, refresh: function() {
        var e = this;
        e.textarea && (e.textarea.val(e.value()), e.wrapper.find("iframe").remove(), e._initializeContentElement(e), e.value(e.textarea.val()))
      }, events: ["select", "change", "execute", "error", "paste", "keydown", "keyup"], options: {name: "Editor", messages: x, formats: {}, encoded: !0, domain: null, resizable: !1, serialization: {entities: !0, semantic: !0, scripts: !1}, stylesheets: [], dialogOptions: {modal: !0, resizable: !1, draggable: !0, animation: !1}, imageBrowser: null, fileBrowser: null, fontName: [{text: "Arial", value: "Arial,Helvetica,sans-serif"}, {text: "Courier New", value: "'Courier New',Courier,monospace"}, {text: "Georgia", value: "Georgia,serif"}, {text: "Impact", value: "Impact,Charcoal,sans-serif"}, {text: "Lucida Console", value: "'Lucida Console',Monaco,monospace"}, {text: "Tahoma", value: "Tahoma,Geneva,sans-serif"}, {text: "Times New Roman", value: "'Times New Roman',Times,serif"}, {text: "Trebuchet MS", value: "'Trebuchet MS',Helvetica,sans-serif"}, {text: "Verdana", value: "Verdana,Geneva,sans-serif"}], fontSize: [{text: "1 (8pt)", value: "xx-small"}, {text: "2 (10pt)", value: "x-small"}, {text: "3 (12pt)", value: "small"}, {text: "4 (14pt)", value: "medium"}, {text: "5 (18pt)", value: "large"}, {text: "6 (24pt)", value: "x-large"}, {text: "7 (36pt)", value: "xx-large"}], formatBlock: [{text: "Paragraph", value: "p"}, {text: "Quotation", value: "blockquote"}, {text: "Heading 1", value: "h1"}, {text: "Heading 2", value: "h2"}, {text: "Heading 3", value: "h3"}, {text: "Heading 4", value: "h4"}, {text: "Heading 5", value: "h5"}, {text: "Heading 6", value: "h6"}], tools: [].concat.call(["formatting"], _.basic, _.alignment, _.lists, _.indenting, _.links, ["insertImage"], _.tables)}, destroy: function() {
        l.fn.destroy.call(this), this._deregisterHandlers(), clearTimeout(this._spellCorrectTimeout), this._focusOutside(), this.toolbar.destroy(), o.destroy(this.wrapper)
      }, _focusOutside: function() {
        if (o.support.browser.msie && this.textarea) {
          var t = e("<input style='position:absolute;left:-10px;top:-10px;width:1px;height:1px;font-size:0;border:1;' />").appendTo(document.body).focus();
          t.blur().remove()
        }
      }, state: function(e) {
        var t, n, r = b.defaultTools[e], i = r && (r.options.finder || r.finder), s = o.ui.editor.RangeUtils;
        return i ? (t = this.getRange(), n = s.textNodes(t), !n.length && t.collapsed && (n = [t.startContainer]), i.getFormat ? i.getFormat(n) : i.isFormatted(n)) : !1
      }, value: function(e) {
        var n = this.body, r = o.ui.editor, i = r.Serializer.domToXhtml(n, this.options.serialization);
        return e === t ? i : (e != i && (r.Serializer.htmlToDom(e, n), u.msie || o.ui.editor.Dom.ensureTrailingBreaks(this.body), this.selectionRestorePoint = null, this.update(), this.toolbar.refreshTools()), t)
      }, saveSelection: function(t) {
        t = t || this.getRange();
        var n = t.commonAncestorContainer, r = this.body;
        (n == r || e.contains(r, n)) && (this.selectionRestorePoint = new o.ui.editor.RestorePoint(t))
      }, _focusBody: function() {
        var e, t = this.body, n = this.wrapper && this.wrapper.find("iframe")[0], r = this.document.documentElement, i = o._activeElement();
        i != t && i != n && (e = r.scrollTop, t.focus(), r.scrollTop = e)
      }, restoreSelection: function() {
        this._focusBody(), this.selectionRestorePoint && this.selectRange(this.selectionRestorePoint.toRange())
      }, focus: function() {
        this.restoreSelection()
      }, update: function(e) {
        e = e || this.options.encoded ? this.encodedValue() : this.value(), this.textarea ? this.textarea.val(e) : this._oldValue = e
      }, encodedValue: function() {
        return o.ui.editor.Dom.encode(this.value())
      }, createRange: function(e) {
        return o.ui.editor.RangeUtils.createRange(e || this.document)
      }, getSelection: function() {
        return o.ui.editor.SelectionUtils.selectionFromDocument(this.document)
      }, selectRange: function(e) {
        this._focusBody();
        var t = this.getSelection();
        t.removeAllRanges(), t.addRange(e), this.saveSelection(e)
      }, getRange: function() {
        var e = this.getSelection(), t = e && e.rangeCount > 0 ? e.getRangeAt(0) : this.createRange(), n = this.document;
        return t.startContainer != n || t.endContainer != n || t.startOffset || t.endOffset || (t.setStart(this.body, 0), t.collapse(!0)), t
      }, selectedHtml: function() {
        return o.ui.editor.Serializer.domToXhtml(this.getRange().cloneContents())
      }, paste: function(t, n) {
        this.focus();
        var r = new o.ui.editor.InsertHtmlCommand(e.extend({range: this.getRange(), html: t}, n));
        r.editor = this, r.exec()
      }, exec: function(e, n) {
        var r, i, s, o, a = this, l = null;
        if (!e)
          throw Error("kendoEditor.exec(): `name` parameter cannot be empty");
        if ("true" !== a.body.getAttribute("contenteditable") && "print" !== e)
          return!1;
        if (e = e.toLowerCase(), a.keyboard.isTypingInProgress() || a.restoreSelection(), i = a.toolbar.toolById(e), !i)
          for (o in b.defaultTools)
            if (o.toLowerCase() == e) {
              i = b.defaultTools[o];
              break
            }
        if (i) {
          if (r = a.getRange(), i.command && (l = i.command(c({range: r}, n))), s = a.trigger("execute", {name: e, command: l}))
            return;
          if (/^(undo|redo)$/i.test(e))
            a.undoRedoStack[e]();
          else if (l && (l.managesUndoRedo || a.undoRedoStack.push(l), l.editor = a, l.exec(), l.async))
            return l.change = m(a._selectionChange, a), t;
          a._selectionChange()
        }
      }});
    b.defaultTools = {undo: {options: {key: "Z", ctrl: !0}}, redo: {options: {key: "Y", ctrl: !0}}}, o.ui.plugin(b), n = a.extend({init: function(e) {
        this.options = e
      }, initialize: function(e, t) {
        e.attr({unselectable: "on", title: t.title}), e.children(".k-tool-text").html(t.title)
      }, command: function(e) {
        return new this.options.command(e)
      }, update: e.noop}), n.exec = function(e, t, n) {
      e.exec(t, {value: n})
    }, r = n.extend({init: function(e) {
        n.fn.init.call(this, e)
      }, command: function(e) {
        var t = this;
        return new o.ui.editor.FormatCommand(c(e, {formatter: t.options.formatter}))
      }, update: function(e, t) {
        var n = this.options.finder.isFormatted(t);
        e.toggleClass("k-state-selected", n), e.attr("aria-pressed", n)
      }}), g.registerTool("separator", new n({template: new f({template: g.separatorTemplate})})), i = u.msie && 9 > u.version ? "\ufeff" : "", s = '<br class="k-br" />', u.msie && (10 > u.version ? s = "\ufeff" : 11 > u.version && (s = " ")), c(o.ui, {editor: {ToolTemplate: f, EditorUtils: g, Tool: n, FormatTool: r, _bomFill: i, emptyElementContent: s}}), o.PDFMixin && (o.PDFMixin.extend(b.prototype), b.prototype._drawPDF = function() {
      return o.drawing.drawDOM(this.body, this.options.pdf)
    }, b.prototype.saveAsPDF = function() {
      var t, n, r = new e.Deferred, i = r.promise(), s = {promise: i};
      return this.trigger("pdfExport", s) ? void 0 : (t = this.options.pdf, n = t.paperSize, this._drawPDF(r).then(function(e) {
        return t.paperSize = "auto", o.drawing.exportPDF(e, t)
      }).done(function(e) {
        o.saveAs({dataURI: e, fileName: t.fileName, proxyURL: t.proxyURL, forceProxy: t.forceProxy}), t.paperSize = n, r.resolve()
      }).fail(function(e) {
        r.reject(e)
      }), i)
    })
  }(window.jQuery)
}, "function" == typeof define && define.amd ? define : function(e, t, n) {
  (n || t)()
}), function(e, t) {
  t("kendo.pivotgrid.min", ["kendo.dom.min", "kendo.data.min"], e)
}(function() {
  return function(e, t) {
    function n(e) {
      var n = "string" == typeof e ? [{name: e}] : e, r = "[object Array]" === ve.call(n) ? n : n !== t ? [n] : [];
      return be(r, function(e) {
        return"string" == typeof e ? {name: e} : {name: e.name, type: e.type}
      })
    }
    function r(e) {
      var n = "string" == typeof e ? [{name: [e], expand: !1}] : e, r = "[object Array]" === ve.call(n) ? n : n !== t ? [n] : [];
      return be(r, function(e) {
        return"string" == typeof e ? {name: [e], expand: !1} : {name: "[object Array]" === ve.call(e.name) ? e.name.slice() : [e.name], expand: e.expand}
      })
    }
    function i(e) {
      return-1 !== e.indexOf(" ") && (e = '["' + e + '"]'), e
    }
    function s(e, t, n, r) {
      var i, o, a, l;
      if (n || (n = t), r || (r = 0), l = n.members[r], l && !l.measure) {
        if (a = l.children, o = a.length, n === t ? e[he.stringify([l.name])] = !!o : o && (e[he.stringify(ae(n, r))] = !0), o)
          for (i = 0; o > i; i++)
            s(e, t, a[i], r);
        s(e, t, n, r + 1)
      }
    }
    function o(t) {
      var n, r, i = {};
      t.length && s(i, t[0]), n = [];
      for (r in i)
        n.push({name: e.parseJSON(r), expand: i[r]});
      return n
    }
    function a(e, t) {
      var n, r, i, s, o = t.tuples || [], a = o[0];
      if (a && a.members.length > e.length)
        for (n = a.members, r = 0; n.length > r; r++)
          if (!n[r].measure) {
            for (i = !1, s = 0; e.length > s; s++)
              if (0 === O(e[s]).indexOf(n[r].hierarchy)) {
                i = !0;
                break
              }
            i || e.push({name: [n[r].name], expand: !1})
          }
    }
    function l(e) {
      var t, n = [], r = e.members;
      for (t = 0; r.length > t; t++)
        r[t].measure || n.push({name: [r[t].name], expand: r[t].children.length > 0});
      return n
    }
    function d(e, t, n) {
      var i, s;
      return e = e || {}, a(t, e), n.length > 1 && t.push({name: Te, measure: !0, children: r(n)}), i = {members: t}, e.tuples && (s = k(e.tuples, i), s.tuple && (t = l(s.tuple))), t
    }
    function u(e) {
      var t = he.getter(e.field, !0);
      return function(n, r) {
        return e.aggregate(t(n.dataItem), r, n)
      }
    }
    function c(e) {
      return"number" == typeof e && !isNaN(e)
    }
    function m(e) {
      return e && e.getTime
    }
    function h(e) {
      return e[e.length] = {value: "", fmtValue: "", ordinal: e.length}, e
    }
    function p(e, n, r) {
      return e.tuples.length < v(n.tuples, r) ? n : t
    }
    function f(e, t, n, r, i) {
      var s, o, a, l = e.length, d = v(t, r), u = r.length || 1;
      for (o = 0; n > o; o++)
        for (s = 0; l > s; s++)
          a = x(e[s], t) * u, a += s % u, i[o * l + s].ordinal = o * d + a
    }
    function g(e, t, n, r, i) {
      var s, o, a, l = e.length, d = r.length || 1;
      for (o = 0; l > o; o++)
        for (a = x(e[o], t), a *= d, a += o % d, s = 0; n > s; s++)
          i[o * n + s].ordinal = a * n + s
    }
    function x(e, t) {
      return k(t, e).index
    }
    function v(e, t) {
      var n, r, i;
      if (!e.length)
        return 0;
      for (n = e.slice(), r = n.shift(), i = 1; r; )
        r.members ? [].push.apply(n, r.members) : r.children && (r.measure || (i += r.children.length), [].push.apply(n, r.children)), r = n.shift();
      return t.length && (i *= t.length), i
    }
    function _(e) {
      return e || (e = {tuples: []}), e.tuples || (e.tuples = []), e
    }
    function b(e, t, n) {
      var r, i, s, o;
      if (!e)
        return 0;
      for (r = Math.max(n.length, 1), i = e.members.slice(0, t), s = r, o = i.shift(), r > 1 && (r += 1); o; )
        o.name === Te ? s += r : o.children ? [].push.apply(i, o.children) : (s++, [].push.apply(i, o.members)), o = i.shift();
      return s
    }
    function w(e, t, n) {
      var r, i, s, o, a, l;
      if (!t[0])
        return{parsedRoot: null, tuples: e, memberIndex: 0, index: 0};
      if (r = k(e, t[0]), !r.tuple)
        return{parsedRoot: null, tuples: t, memberIndex: 0, index: 0};
      if (i = r.tuple.members, s = t[0].members, o = -1, i.length !== s.length)
        return{parsedRoot: null, tuples: t, memberIndex: 0, index: 0};
      for (a = 0, l = i.length; l > a; a++)
        !i[a].measure && s[a].children[0] && (-1 == o && s[a].children.length && (o = a), i[a].children = s[a].children);
      return n = Math.max(n.length, 1), {parsedRoot: r.tuple, index: r.index * n, memberIndex: o, tuples: e}
    }
    function y(e, t) {
      var n, r, i = !0;
      for (e = e.members, t = t.members, n = 0, r = e.length; r > n; n++)
        e[n].measure || t[n].measure || (i = i && O(e[n]) === O(t[n]));
      return i
    }
    function k(e, t) {
      var n, r, i, s, o, a, l, d = 0;
      for (n = 0, r = e.length; r > n; n++) {
        if (i = e[n], y(i, t))
          return{tuple: i, index: d};
        for (d++, o = 0, a = i.members.length; a > o; o++)
          if (l = i.members[o], !l.measure && (s = k(l.children, t), d += s.index, s.tuple))
            return{tuple: s.tuple, index: d}
      }
      return{index: d}
    }
    function S(e, t) {
      var n, r, i, s = "";
      for (r = 0, i = e.length; i > r; r++)
        n = e[r], s += n.name, t[s] || (t[s] = n)
    }
    function T(e, t) {
      var n, r, i, s, o = e.members, a = "", l = "";
      for (n = 0, r = o.length; r > n; n++) {
        if (i = o[n], s) {
          if (t[a + i.name]) {
            a += i.name, s = t[a];
            continue
          }
          return t[a + i.parentName] ? t[a + i.parentName] : t[l + i.parentName] ? t[l + i.parentName] : t[l]
        }
        if (a += i.name, s = t[i.parentName], !s && (s = t[a], !s))
          return null;
        s && (l += s.name)
      }
      return s
    }
    function C(e, t) {
      var n, r, i, s;
      if (0 === t.length)
        return-1;
      for (n = t[0], r = e.members, i = 0, s = r.length; s > i; i++)
        if (r[i].name == n.name)
          return i
    }
    function I(n, r) {
      if (!(0 > r)) {
        var i = {name: Te, measure: !0, children: [e.extend({members: [], dataIndex: n.dataIndex}, n.members[r])]};
        n.members.splice(r, 1, i), n.dataIndex = t
      }
    }
    function N(e, t) {
      var n, r, i, s, o, a;
      if (1 > e.length)
        return[];
      for (n = [], r = {}, i = C(e[0], t), s = 0; e.length > s; s++)
        o = e[s], o.dataIndex = s, I(o, i), a = T(o, r), a ? a.children.push(0 > i || !a.measure ? o : o.members[i].children[0]) : n.push(o), S(o.members, r);
      return n
    }
    function E(e, t) {
      var n, r, i, s, o, a, l, d, u;
      if (!e || !e.length)
        return t;
      for (n = [], r = R(e), i = r.length, s = Math.max(t.length / i, 1), o = 0; i > o; o++)
        for (l = s * o, d = s * r[o], a = 0; s > a; a++)
          u = parseInt(d + a, 10), n[parseInt(l + a, 10)] = t[u] || {value: "", fmtValue: "", ordinal: u};
      return n
    }
    function A(e, t) {
      var n, r, i, s, o, a, l, d;
      if (!e || !e.length)
        return t;
      for (n = [], r = R(e), i = r.length, s = Math.max(t.length / i, 1), a = 0; s > a; a++)
        for (l = i * a, o = 0; i > o; o++)
          d = r[o] + l, n[l + o] = t[d] || {value: "", fmtValue: "", ordinal: d};
      return n
    }
    function R(e) {
      var n, r, i, s, o, a, l;
      for (e = e.slice(), n = [], r = e.shift(); r; ) {
        for (r.dataIndex !== t && n.push(r.dataIndex), o = 0, i = 0, s = r.members.length; s > i; i++)
          l = r.members[i], a = l.children, l.measure ? [].splice.apply(e, [0, 0].concat(a)) : [].splice.apply(e, [o, 0].concat(a)), o += a.length;
        r = e.shift()
      }
      return n
    }
    function M(e) {
      var t = e.split(".");
      return t.length > 2 ? t[0] + "." + t[1] : e
    }
    function D(e, t) {
      var n = e.length - 1, r = e[n], i = H(t, r);
      return i && i.dir ? r = "ORDER(" + r + ".Children," + i.field + ".CurrentMember.MEMBER_CAPTION," + i.dir + ")" : r += ".Children", e[n] = r, e
    }
    function H(e, t) {
      for (var n = 0, r = e.length; r > n; n++)
        if (0 === t.indexOf(e[n].field))
          return e[n];
      return null
    }
    function P(e) {
      var t, n = "CROSSJOIN({";
      return e.length > 2 ? (t = e.pop(), n += P(e)) : (n += e.shift(), t = e.pop()), n += "},{", n += t, n += "})"
    }
    function F(e, t) {
      var n = e.slice(0);
      return t.length > 1 && n.push("{" + L(t).join(",") + "}"), P(n)
    }
    function L(e) {
      for (var n, r = 0, i = e.length, s = []; i > r; r++)
        n = e[r], s.push(n.name !== t ? n.name : n);
      return s
    }
    function O(e) {
      return e = e.name || e, "[object Array]" === ve.call(e) && (e = e[e.length - 1]), e
    }
    function z(e) {
      for (var t = e.length, n = [], r = 0; t > r; r++)
        n.push(e[r].name[0]);
      return n
    }
    function U(e, t) {
      var n, r, i, s = 0, o = e.length, a = t.length;
      for (t = t.slice(0); o > s; s++)
        for (n = e[s], i = 0; a > i; i++)
          if (r = M(t[i]), -1 !== n.indexOf(r)) {
            t[i] = n;
            break
          }
      return{names: t, expandedIdx: i, uniquePath: t.slice(0, i + 1).join("")}
    }
    function B(e) {
      for (var t, n, r, i, s, o, a = [], l = [], d = [], u = 0, c = e.length; c > u; u++)
        if (t = e[u], i = t.name, o = !1, "[object Array]" !== ve.call(i) && (t.name = i = [i]), i.length > 1)
          l.push(t);
        else {
          for (s = M(i[0]), n = 0, r = d.length; r > n; n++)
            if (0 === d[n].name[0].indexOf(s)) {
              o = !0;
              break
            }
          o || d.push(t), t.expand && a.push(t)
        }
      return a = a.concat(l), {root: d, expanded: a}
    }
    function $(e, t, n) {
      var r, i, s, o, a, l, d, u, c = "";
      if (e = e || [], r = B(e), i = r.root, s = z(i), o = [], r = r.expanded, a = r.length, l = 0, u = [], s.length > 1 || t.length > 1) {
        for (o.push(F(s, t)); a > l; l++)
          d = D(r[l].name, n), u = U(d, s).names, o.push(F(u, t));
        c += o.join(",")
      } else {
        for (; a > l; l++)
          d = D(r[l].name, n), u.push(d[0]);
        c += s.concat(u).join(",")
      }
      return c
    }
    function q(e) {
      var t = "", n = e.value, r = e.field, i = e.operator;
      return"in" == i ? (t += "{", t += n, t += "}") : (t += "Filter(", t += r + ".MEMBERS", t += he.format(K[i], r, n), t += ")"), t
    }
    function W(e, t) {
      var n, r, i = "", s = e.filters, o = s.length;
      for (r = o - 1; r >= 0; r--)
        n = "SELECT (", n += q(s[r]), n += ") ON 0", r == o - 1 ? (n += " FROM [" + t + "]", i = n) : i = n + " FROM ( " + i + " )";
      return i
    }
    function V(e, t, n) {
      var r, i, s = "";
      if (t) {
        s += "<" + e + ">";
        for (i in t)
          r = t[i], n && (i = i.replace(/([A-Z]+(?=$|[A-Z][a-z])|[A-Z]?[a-z]+)/g, "$1_").toUpperCase().replace(/_$/, "")), s += "<" + i + ">" + r + "</" + i + ">";
        s += "</" + e + ">"
      } else
        s += "<" + e + "/>";
      return s
    }
    function j(e) {
      if (null == e)
        return[];
      var t = ve.call(e);
      return"[object Array]" !== t ? [e] : e
    }
    function G(e) {
      var t, n, r, i, s = {tuples: []}, o = j(he.getter("Tuples.Tuple", !0)(e)), a = he.getter("Caption['#text']"), l = he.getter("UName['#text']"), d = he.getter("LName['#text']"), u = he.getter("LNum['#text']"), c = he.getter("CHILDREN_CARDINALITY['#text']", !0), m = he.getter("['@Hierarchy']"), h = he.getter("PARENT_UNIQUE_NAME['#text']", !0);
      for (t = 0; o.length > t; t++) {
        for (n = [], r = j(o[t].Member), i = 0; r.length > i; i++)
          n.push({children: [], caption: a(r[i]), name: l(r[i]), levelName: d(r[i]), levelNum: u(r[i]), hasChildren: parseInt(c(r[i]), 10) > 0, parentName: h(r[i]), hierarchy: m(r[i])});
        s.tuples.push({members: n})
      }
      return s
    }
    var K, Y, Q, X, J, Z, ee, te, ne, re, ie, se, oe, ae, le, de, ue, ce, me, he = window.kendo, pe = he.ui, fe = he.Class, ge = pe.Widget, xe = he.data.DataSource, ve = {}.toString, _e = function(e) {
      return e
    }, be = e.map, we = e.extend, ye = he.isFunction, ke = "change", Se = "error", Te = "Measures", Ce = "progress", Ie = "stateReset", Ne = "auto", Ee = "<div/>", Ae = ".kendoPivotGrid", Re = "__row_total__", Me = "dataBinding", De = "dataBound", He = "expandMember", Pe = "collapseMember", Fe = "k-i-arrow-s", Le = "k-i-arrow-e", Oe = "<span>#: data.member.caption || data.member.name #</span>", ze = '<span class="k-icon k-i-kpi-#=data.dataItem.value > 0 ? "open" : data.dataItem.value < 0 ? "denied" : "hold"#">#:data.dataItem.value#</span>', Ue = '<span class="k-icon k-i-kpi-#=data.dataItem.value > 0 ? "increase" : data.dataItem.value < 0 ? "decrease" : "equal"#">#:data.dataItem.value#</span>', Be = '#= data.dataItem ? kendo.htmlEncode(data.dataItem.fmtValue || data.dataItem.value) || "&nbsp;" : "&nbsp;" #', $e = '<table class="k-pivot-layout"><tr><td><div class="k-pivot-rowheaders"></div></td><td><div class="k-pivot-table k-state-default"></div></td></tr></table>', qe = {sum: function(e, t) {
        var n = t.accumulator;
        return c(n) ? c(e) && (n += e) : n = e, n
      }, count: function(e, t) {
        return(t.accumulator || 0) + 1
      }, average: {aggregate: function(e, n) {
          var r = n.accumulator;
          return n.count === t && (n.count = 0), c(r) ? c(e) && (r += e) : r = e, c(e) && n.count++, r
        }, result: function(e) {
          var t = e.accumulator;
          return c(t) && (t /= e.count), t
        }}, max: function(e, t) {
        var n = t.accumulator;
        return c(n) || m(n) || (n = e), e > n && (c(e) || m(e)) && (n = e), n
      }, min: function(e, t) {
        var n = t.accumulator;
        return c(n) || m(n) || (n = e), n > e && (c(e) || m(e)) && (n = e), n
      }}, We = fe.extend({init: function(e) {
        this.options = we({}, this.options, e), this.dimensions = this._normalizeDescriptors("field", this.options.dimensions), this.measures = this._normalizeDescriptors("name", this.options.measures)
      }, _normalizeDescriptors: function(e, t) {
        var n, r, i, s;
        if (t = t || {}, n = {}, "[object Array]" === ve.call(t)) {
          for (i = 0, s = t.length; s > i; i++)
            r = t[i], "string" == typeof r ? n[r] = {} : r[e] && (n[r[e]] = r);
          t = n
        }
        return t
      }, _rootTuples: function(e, n) {
        var r, i, s, o, a = n.length || 1, l = this.dimensions || [], d = 0, u = e.length, c = [], m = [];
        if (u || n.length) {
          for (d = 0; a > d; d++) {
            for (r = {members:[]}, o = 0; u > o; o++)
              i = e[o], s = i.split("&"), r.members[r.members.length] = {children: [], caption: (l[i] || {}).caption || "All", name: i, levelName: i, levelNum: "0", hasChildren: !0, parentName: s.length > 1 ? s[0] : t, hierarchy: i};
            a > 1 && (r.members[r.members.length] = {children: [], caption: n[d].caption, name: n[d].descriptor.name, levelName: "MEASURES", levelNum: "0", hasChildren: !1, parentName: t, hierarchy: "MEASURES"}), c[c.length] = r
          }
          m.push(Re)
        }
        return{keys: m, tuples: c}
      }, _expandedTuples: function(e, n, r) {
        var i, s, o, a, l, d, u, c, m, h, p, f = r.length || 1, g = this.dimensions || [], x = [], v = [];
        for (o in e) {
          for (a = e[o], u = this._findExpandedMember(n, a.uniquePath), l = x[u.index] || [], d = v[u.index] || [], c = u.member.names, i = 0; f > i; i++) {
            for (s = {members:[]}, p = 0; c.length > p; p++)
              p === u.member.expandedIdx ? (s.members[s.members.length] = {children: [], caption: a.value, name: a.name, hasChildren: !1, levelNum: 1, levelName: a.parentName + a.name, parentName: a.parentName, hierarchy: a.parentName + a.name}, 0 === i && d.push(ae(s, p).join(""))) : (h = c[p], m = h.split("&"), s.members[s.members.length] = {children: [], caption: (g[h] || {}).caption || "All", name: h, levelName: h, levelNum: "0", hasChildren: !0, parentName: m.length > 1 ? m[0] : t, hierarchy: h});
            f > 1 && (s.members[s.members.length] = {children: [], caption: r[i].caption, name: r[i].descriptor.name, levelName: "MEASURES", levelNum: "0", hasChildren: !0, parentName: t, hierarchy: "MEASURES"}), l[l.length] = s
          }
          x[u.index] = l, v[u.index] = d
        }
        return{keys: v, tuples: x}
      }, _findExpandedMember: function(e, t) {
        for (var n = 0; e.length > n; n++)
          if (e[n].uniquePath === t)
            return{member: e[n], index: n}
      }, _asTuples: function(e, t, n) {
        var r, i;
        return n = n || [], r = this._rootTuples(t.root, n), i = this._expandedTuples(e, t.expanded, n), {keys: [].concat.apply(r.keys, i.keys), tuples: [].concat.apply(r.tuples, i.tuples)}
      }, _measuresInfo: function(e, t) {
        for (var n, r, i = 0, s = e && e.length, o = [], a = {}, l = {}, d = this.measures || {}; s > i; i++)
          r = e[i].descriptor.name, n = d[r] || {}, o.push(r), n.result && (a[r] = n.result), n.format && (l[r] = n.format);
        return{names: o, formats: l, resultFuncs: a, rowAxis: t}
      }, _toDataArray: function(e, t, n, r) {
        var i, s, o, a, l, d, u, c, m, h, p = [], f = 1, g = [], x = n.length || 1, v = r.length || 1;
        for (t.rowAxis?(g = t.names, f = g.length):h = t.names, o = 0; x > o; o++)
          for (u = e[n[o] || Re], d = 0; f > d; d++)
            for (t.rowAxis && (h = [g[d]]), a = 0; v > a; a++)
              for (m = r[a] || Re, c = u.items[m], i = m === Re?u.aggregates:c?c.aggregates:{}, l = 0; h.length > l; l++)
                s = h[l], this._addData(p, i[s], t.formats[s], t.resultFuncs[s]);
        return p
      }, _addData: function(e, t, n, r) {
        var i, s = "";
        t && (t = r ? r(t) : t.accumulator, s = n ? he.format(n, t) : t), i = e.length, e[i] = {ordinal: i, value: t || "", fmtValue: s}
      }, _matchDescriptors: function(e, n, r) {
        for (var i, s, o, a, l = n.names, d = n.expandedIdx; d > 0; )
          if (i = l[--d].split("&"), i.length > 1 && (s = i[0], o = i[1], a = r[s](e), a = a !== t && null !== a ? "" + a : a, a != o))
            return!1;
        return!0
      }, _calculateAggregate: function(e, t, n) {
        var r, i, s, o = {};
        for (s = 0; e.length > s; s++)
          i = e[s].descriptor.name, r = n.aggregates[i] || {}, r.accumulator = e[s].aggregator(t, r), o[i] = r;
        return o
      }, _processColumns: function(e, n, r, i, s, o, a, l) {
        for (var d, u, c, m, h, p, f, g, x = s.dataItem, v = 0; n.length > v; v++)
          u = n[v], this._matchDescriptors(x, u, r) && (g = u.names.slice(0, u.expandedIdx).join(""), p = u.names[u.expandedIdx], d = r[p](x), d = d !== t && null !== d ? "" + d : d, f = p, p = p + "&" + d, h = g + p, c = i[h] || {index: a.columnIndex, parentName: f, name: p, uniquePath: g + f, value: d}, m = o.items[h] || {aggregates: {}}, o.items[h] = {index: c.index, aggregates: this._calculateAggregate(e, s, m)}, l && (i[h] || a.columnIndex++, i[h] = c))
      }, _measureAggregators: function(e) {
        var t, n, r, i, s, o, a = e.measures || [], l = this.measures || {}, d = [];
        if (a.length) {
          for (r = 0, i = a.length; i > r; r++)
            if (t = a[r], n = l[t.name], s = null, n) {
              if (o = n.aggregate, "string" == typeof o) {
                if (s = qe[o.toLowerCase()], !s)
                  throw Error("There is no such aggregate function");
                n.aggregate = s.aggregate || s, n.result = s.result
              }
              d.push({descriptor: t, caption: n.caption, result: n.result, aggregator: u(n)})
            }
        } else
          d.push({descriptor: {name: "default"}, caption: "default", aggregator: function() {
              return 1
            }});
        return d
      }, _buildGetters: function(e) {
        var t, n, r, s = {};
        for (r = 0; e.length > r; r++)
          n = e[r], t = n.split("&"), t.length > 1 ? s[t[0]] = he.getter(t[0], !0) : s[n] = he.getter(i(n), !0);
        return s
      }, _parseDescriptors: function(e) {
        var t, n = B(e), r = z(n.root), i = n.expanded, s = [];
        for (t = 0; i.length > t; t++)
          s.push(U(i[t].name, r));
        return{root: r, expanded: s}
      }, _filter: function(e, t) {
        var n, r, i;
        if (!t)
          return e;
        for (r = 0, i = t.filters; i.length > r; r++)
          n = i[r], "in" === n.operator && (i[r] = this._normalizeFilter(n));
        return new he.data.Query(e).filter(t).data
      }, _normalizeFilter: function(e) {
        var t, n = e.value.split(","), r = [];
        if (!n.length)
          return n;
        for (t = 0; n.length > t; t++)
          r.push({field: e.field, operator: "eq", value: n[t]});
        return{logic: "or", filters: r}
      }, process: function(e, n) {
        var i, s, o, a, l, d, u, c, m, h, p, f, g, x, v, _, b, w, y, k, S, T, C, I, N, E, A, R, M, D;
        if (e = e || [], n = n || {}, e = this._filter(e, n.filter), i = n.measures || [], s = "rows" === n.measuresAxis, o = n.columns || [], a = n.rows || [], !o.length && a.length && (!i.length || i.length && s) && (o = a, a = [], s = !1), o.length || a.length || (s = !1), !o.length && i.length && (o = r(n.measures)), o = this._parseDescriptors(o), a = this._parseDescriptors(a), l = {}, d = {}, u = {}, m = {columnIndex: 0}, h = this._measureAggregators(n), p = this._buildGetters(o.root), f = this._buildGetters(a.root), g = !1, x = o.expanded, v = a.expanded, w = 0 !== v.length, M = e.length, D = 0, o.root.length || a.root.length)
          for (g = !0, D = 0; M > D; D++)
            for (_ = e[D], b = {dataItem:_, index:D}, T = l[Re] || {items:{}, aggregates:{}}, this._processColumns(h, x, p, d, b, T, m, !w), T.aggregates = this._calculateAggregate(h, b, T), l[Re] = T, y = 0; v.length > y; y++)
              k = v[y], this._matchDescriptors(_, k, f) ? (I = k.names.slice(0, k.expandedIdx).join(""), S = k.names[k.expandedIdx], N = S, c = f[S](_), c = c !== t ? "" + c : c, S = S + "&" + c, C = I + S, u[C] = {uniquePath: I + N, parentName: N, name: S, value: c}, E = l[C] || {items: {}, aggregates: {}}, this._processColumns(h, x, p, d, b, E, m, !0), E.aggregates = this._calculateAggregate(h, b, E), l[C] = E) : this._processColumns(h, x, p, d, b, {items: {}, aggregates: {}}, m, !0);
        return g && M ? (!(h.length > 1) || n.columns && n.columns.length || (o = {root: [], expanded: []}), A = this._asTuples(d, o, s ? [] : h), R = this._asTuples(u, a, s ? h : []), d = A.tuples, u = R.tuples, l = this._toDataArray(l, this._measuresInfo(h, s), R.keys, A.keys)) : l = d = u = [], {axes: {columns: {tuples: d}, rows: {tuples: u}}, data: l}
      }}), Ve = fe.extend({init: function(e, t) {
        this.transport = t, this.options = t.options || {}, this.transport.discover || ye(e.discover) && (this.discover = e.discover)
      }, read: function(e) {
        return this.transport.read(e)
      }, update: function(e) {
        return this.transport.update(e)
      }, create: function(e) {
        return this.transport.create(e)
      }, destroy: function(e) {
        return this.transport.destroy(e)
      }, discover: function(e) {
        return this.transport.discover ? this.transport.discover(e) : (e.success({}), t)
      }, catalog: function(n) {
        var r, i = this.options || {};
        return n === t ? (i.connection || {}).catalog : (r = i.connection || {}, r.catalog = n, this.options.connection = r, e.extend(this.transport.options, {connection: r}), t)
      }, cube: function(e) {
        var n, r = this.options || {};
        return e === t ? (r.connection || {}).cube : (n = r.connection || {}, n.cube = e, this.options.connection = n, we(!0, this.transport.options, {connection: n}), t)
      }}), je = xe.extend({init: function(t) {
        var i, s = ((t || {}).schema || {}).cube, o = "columns", a = {axes: _e, cubes: _e, catalogs: _e, measures: _e, dimensions: _e, hierarchies: _e, levels: _e, members: _e};
        s && (a = e.extend(a, this._cubeSchema(s)), this.cubeBuilder = new We(s)), xe.fn.init.call(this, we(!0, {}, {schema: a}, t)), this.transport = new Ve(this.options.transport || {}, this.transport), this._columns = r(this.options.columns), this._rows = r(this.options.rows), i = this.options.measures || [], "[object Object]" === ve.call(i) && (o = i.axis || "columns", i = i.values || []), this._measures = n(i), this._measuresAxis = o, this._skipNormalize = 0, this._axes = {}
      }, _cubeSchema: function(t) {
        return{dimensions: function() {
            var e, n = [], r = t.dimensions;
            for (e in r)
              n.push({name: e, caption: r[e].caption || e, uniqueName: e, defaultHierarchy: e, type: 1});
            return t.measures && n.push({name: Te, caption: Te, uniqueName: Te, type: 2}), n
          }, hierarchies: function() {
            return[]
          }, measures: function() {
            var e, n = [], r = t.measures;
            for (e in r)
              n.push({name: e, caption: e, uniqueName: e, aggregator: e});
            return n
          }, members: e.proxy(function(e, n) {
            var r, s, o = n.levelUniqueName || n.memberUniqueName, a = he.getter(this.options.schema.data, !0), l = a(this.options.data) || this._rawData || [], d = [], u = 0, c = {};
            if (o && (o = o.split(".")[0]), !n.treeOp)
              return d.push({caption: t.dimensions[o].caption || o, childrenCardinality: "1", dimensionUniqueName: o, hierarchyUniqueName: o, levelUniqueName: o, name: o, uniqueName: o}), d;
            for (r = he.getter(i(o), !0); l.length > u; u++)
              s = r(l[u]), !s && 0 !== s || c[s] || (c[s] = !0, d.push({caption: s, childrenCardinality: "0", dimensionUniqueName: o, hierarchyUniqueName: o, levelUniqueName: o, name: s, uniqueName: s}));
            return d
          }, this)}
      }, options: {serverSorting: !0, serverPaging: !0, serverFiltering: !0, serverGrouping: !0, serverAggregates: !0}, catalog: function(e) {
        return e === t ? this.transport.catalog() : (this.transport.catalog(e), this._mergeState({}), this._axes = {}, this.data([]), t)
      }, cube: function(e) {
        return e === t ? this.transport.cube() : (this.transport.cube(e), this._axes = {}, this._mergeState({}), this.data([]), t)
      }, axes: function() {
        return this._axes
      }, columns: function(e) {
        return e === t ? this._columns : (this._skipNormalize += 1, this._clearAxesData = !0, this._columns = r(e), this.query({columns: e, rows: this.rowsAxisDescriptors(), measures: this.measures()}), t)
      }, rows: function(e) {
        return e === t ? this._rows : (this._skipNormalize += 1, this._clearAxesData = !0, this._rows = r(e), this.query({columns: this.columnsAxisDescriptors(), rows: e, measures: this.measures()}), t)
      }, measures: function(e) {
        return e === t ? this._measures : (this._skipNormalize += 1, this._clearAxesData = !0, this.query({columns: this.columnsAxisDescriptors(), rows: this.rowsAxisDescriptors(), measures: n(e)}), t)
      }, measuresAxis: function() {
        return this._measuresAxis || "columns"
      }, _expandPath: function(e, t) {
        var n, i, s, o = "columns" === t ? "columns" : "rows", a = "columns" === t ? "rows" : "columns", l = r(e), u = O(l[l.length - 1]);
        for (this._lastExpanded = o, l = d(this.axes()[o], l, this.measures()), n = 0; l.length > n; n++)
          if (i = O(l[n]), i === u) {
            if (l[n].expand)
              return;
            l[n].expand = !0
          } else
            l[n].expand = !1;
        s = {}, s[o] = l, s[a] = this._descriptorsForAxis(a), this._query(s)
      }, _descriptorsForAxis: function(e) {
        var t = this.axes(), n = this[e]() || [];
        return t && t[e] && t[e].tuples && t[e].tuples[0] && (n = o(t[e].tuples || [])), n
      }, columnsAxisDescriptors: function() {
        return this._descriptorsForAxis("columns")
      }, rowsAxisDescriptors: function() {
        return this._descriptorsForAxis("rows")
      }, _process: function(e, t) {
        this._view = e, t = t || {}, t.items = t.items || this._view, this.trigger(ke, t)
      }, _query: function(e) {
        var t = this;
        return e || (this._skipNormalize += 1, this._clearAxesData = !0), t.query(we({}, {page: t.page(), pageSize: t.pageSize(), sort: t.sort(), filter: t.filter(), group: t.group(), aggregate: t.aggregate(), columns: this.columnsAxisDescriptors(), rows: this.rowsAxisDescriptors(), measures: this.measures()}, e))
      }, query: function(t) {
        var n = this._mergeState(t);
        return this._data.length && this.cubeBuilder ? (this._params(n), this._updateLocalData(this._pristineData), e.Deferred().resolve().promise()) : this.read(n)
      }, _mergeState: function(e) {
        return e = xe.fn._mergeState.call(this, e), e !== t && (this._measures = n(e.measures), e.columns ? e.columns = r(e.columns) : e.columns || (this._columns = []), e.rows ? e.rows = r(e.rows) : e.rows || (this._rows = [])), e
      }, filter: function(e) {
        return e === t ? this._filter : (this._skipNormalize += 1, this._clearAxesData = !0, this._query({filter: e, page: 1}), t)
      }, expandColumn: function(e) {
        this._expandPath(e, "columns")
      }, expandRow: function(e) {
        this._expandPath(e, "rows")
      }, success: function(e) {
        var t;
        this.cubeBuilder && (t = (this.reader.data(e) || []).slice(0)), xe.fn.success.call(this, e), t && (this._pristineData = t)
      }, _processResult: function(e, t) {
        var n, r, i, s, o, a, l, d, u, c, m;
        return this.cubeBuilder && (n = this.cubeBuilder.process(e, this._requestData), e = n.data, t = n.axes), d = this.columns(), u = this.rows(), c = t.columns && t.columns.tuples, d.length || !u.length || !c || !this._rowMeasures().length && this.measures().length || (t = {columns: {}, rows: t.columns}), d.length || u.length || "rows" !== this.measuresAxis() || !c || (t = {columns: {}, rows: t.columns}), this._axes = {columns: _(this._axes.columns), rows: _(this._axes.rows)}, t = {columns: _(t.columns), rows: _(t.rows)}, r = this._normalizeTuples(t.columns.tuples, this._axes.columns.tuples, d, this._columnMeasures()), i = this._normalizeTuples(t.rows.tuples, this._axes.rows.tuples, u, this._rowMeasures()), this._skipNormalize -= 1, this.cubeBuilder || (e = this._normalizeData({columnsLength: t.columns.tuples.length, rowsLength: t.rows.tuples.length, columnIndexes: r, rowIndexes: i, data: e})), "rows" == this._lastExpanded ? (s = t.columns.tuples, a = this._columnMeasures(), o = p(t.columns, this._axes.columns, a), o && (l = "columns", t.columns = o, f(s, o.tuples, t.rows.tuples.length, a, e), this.cubeBuilder || (e = this._normalizeData({columnsLength: v(t.columns.tuples, a), rowsLength: t.rows.tuples.length, data: e})))) : "columns" == this._lastExpanded && (s = t.rows.tuples, a = this._rowMeasures(), o = p(t.rows, this._axes.rows, a), o && (l = "rows", t.rows = o, g(s, o.tuples, t.columns.tuples.length, a, e), this.cubeBuilder || (e = this._normalizeData({columnsLength: v(t.rows.tuples, a), rowsLength: t.columns.tuples.length, data: e})))), this._lastExpanded = null, m = this._mergeAxes(t, e, l), this._axes = m.axes, m.data
      }, _readData: function(e) {
        var t = this.reader.axes(e), n = this.reader.data(e);
        return this.cubeBuilder && (this._rawData = n), this._processResult(n, t)
      }, _createTuple: function(e, t, n) {
        var r, i, s, o, a, l, d, u, c = e.members, m = c.length, h = {members: []}, p = 0;
        for (t && (m -= 1); m > p; p++)
          u = c[p], i = +u.levelNum, s = u.name, o = u.parentName, d = u.caption || s, a = u.hasChildren, l = u.hierarchy, r = u.levelName, n && (d = "All", 0 === i ? o = u.name : i -= 1, a = !0, s = l = r = o), h.members.push({name: s, children: [], caption: d, levelName: r, levelNum: "" + i, hasChildren: a, hierarchy: l, parentName: n ? "" : o});
        return t && h.members.push({name: t.name, children: []}), h
      }, _hasRoot: function(e, t, n) {
        var r, i, s, o, a, l, d;
        if (t.length)
          return k(t, e).tuple;
        for (r = e.members, o = !0, l = 0, d = r.length; d > l; l++)
          if (i = r[l], a = +i.levelNum || 0, s = n[l], !(0 === a || s && i.name === O(s))) {
            o = !1;
            break
          }
        return o
      }, _mergeAxes: function(e, t, n) {
        var r, i, s, o, a, l = this._columnMeasures(), d = this._rowMeasures(), u = this.axes(), c = v(u.rows.tuples, d), m = e.rows.tuples.length, h = v(u.columns.tuples, l), p = e.columns.tuples.length;
        return"columns" == n ? (p = h, i = e.columns.tuples) : (i = N(e.columns.tuples, l), t = A(i, t)), s = w(u.columns.tuples, i, l), "rows" == n ? (m = v(e.rows.tuples, d), i = e.rows.tuples) : (i = N(e.rows.tuples, d), t = E(i, t)), o = w(u.rows.tuples, i, d), u.columns.tuples = s.tuples, u.rows.tuples = o.tuples, h !== v(u.columns.tuples, l) ? (r = s.index + b(s.parsedRoot, s.memberIndex, l), a = h + p, t = this._mergeColumnData(t, r, m, p, a)) : c !== v(u.rows.tuples, d) && (r = o.index + b(o.parsedRoot, o.memberIndex, d), t = this._mergeRowData(t, r, m, p)), 0 === u.columns.tuples.length && 0 === u.rows.tuples.length && (t = []), {axes: u, data: t}
      }, _mergeColumnData: function(e, t, n, r, i) {
        var s, o, a, l = this.data().toJSON(), d = 0, u = Math.max(this._columnMeasures().length, 1);
        for (n = Math.max(n, 1), l.length > 0 && (d = u, i -= u), s = 0; n > s; s++)
          o = t + s * i, a = e.splice(0, r), a.splice(0, d), [].splice.apply(l, [o, 0].concat(a));
        return l
      }, _mergeRowData: function(e, t, n, r) {
        var i, s, o, a = this.data().toJSON(), l = Math.max(this._rowMeasures().length, 1);
        for (r = Math.max(r, 1), a.length > 0 && (n -= l, e.splice(0, r * l)), i = 0; n > i; i++)
          o = e.splice(0, r), s = t * r + i * r, [].splice.apply(a, [s, 0].concat(o));
        return a
      }, _columnMeasures: function() {
        var e = this.measures(), t = [];
        return"columns" === this.measuresAxis() && (0 === this.columns().length ? t = e : e.length > 1 && (t = e)), t
      }, _rowMeasures: function() {
        var e = this.measures(), t = [];
        return"rows" === this.measuresAxis() && (0 === this.rows().length ? t = e : e.length > 1 && (t = e)), t
      }, _updateLocalData: function(e, t) {
        this.cubeBuilder && (t && (this._requestData = t), e = this._processResult(e)), this._data = this._observe(e), this._ranges = [], this._addRange(this._data), this._total = this._data.length, this._pristineTotal = this._total, this._process(this._data)
      }, data: function(e) {
        var n = this;
        return e === t ? n._data : (this._pristineData = e.slice(0), this._updateLocalData(e, {columns: this.columns(), rows: this.rows(), measures: this.measures()}), t)
      }, _normalizeTuples: function(e, t, n, r) {
        var i, s, o, a = r.length || 1, l = 0, d = [], u = {}, c = 0;
        if (e.length) {
          if (0 >= this._skipNormalize && !this._hasRoot(e[0], t, n)) {
            for (this._skipNormalize = 0; a > l; l++)
              d.push(this._createTuple(e[0], r[l], !0)), u[l] = l;
            e.splice.apply(e, [0, e.length].concat(d).concat(e)), l = a
          }
          if (r.length)
            for (o = i = e[l], s = i.members.length - 1; i; ) {
              if (c >= a && (c = 0), i.members[s].name !== r[c].name && (e.splice(l, 0, this._createTuple(i, r[c])), u[l] = l), l += 1, c += 1, i = e[l], a > c && (!i || le(o, s - 1) !== le(i, s - 1))) {
                for (; a > c; c++)
                  e.splice(l, 0, this._createTuple(o, r[c])), u[l] = l, l += 1;
                i = e[l]
              }
              o = i
            }
          return u
        }
      }, _addMissingDataItems: function(e, n) {
        for (; n.rowIndexes[parseInt(e.length / n.columnsLength, 10)] !== t; )
          for (var r = 0; n.columnsLength > r; r++)
            e = h(e);
        for (; n.columnIndexes[e.length % n.columnsLength] !== t; )
          e = h(e);
        return e
      }, _normalizeOrdinals: function(e, t, n) {
        var r = n.lastOrdinal;
        if (!t)
          return h(e);
        if (t.ordinal - r > 1)
          for (r += 1; t.ordinal > r && n.length > e.length; )
            e = this._addMissingDataItems(h(e), n), r += 1;
        return t.ordinal = e.length, e[e.length] = t, e
      }, _normalizeData: function(e) {
        var t, n, r, i = e.data, s = 0, o = [];
        if (e.lastOrdinal = 0, e.columnIndexes = e.columnIndexes || {}, e.rowIndexes = e.rowIndexes || {}, e.columnsLength = e.columnsLength || 1, e.rowsLength = e.rowsLength || 1, e.length = e.columnsLength * e.rowsLength, r = e.length, i.length === r)
          return i;
        for (; r > o.length; )
          t = i[s++], t && (n = t.ordinal), o = this._normalizeOrdinals(this._addMissingDataItems(o, e), t, e), e.lastOrdinal = n;
        return o
      }, discover: function(t, n) {
        var r = this, i = r.transport;
        return e.Deferred(function(e) {
          i.discover(we({success: function(t) {
              t = r.reader.parse(t), r._handleCustomErrors(t) || (n && (t = n(t)), e.resolve(t))
            }, error: function(t, n, i) {
              e.reject(t), r.error(t, n, i)
            }}, t))
        }).promise().done(function() {
          r.trigger("schemaChange")
        })
      }, schemaMeasures: function() {
        var e = this;
        return e.discover({data: {command: "schemaMeasures", restrictions: {catalogName: e.transport.catalog(), cubeName: e.transport.cube()}}}, function(t) {
          return e.reader.measures(t)
        })
      }, schemaKPIs: function() {
        var e = this;
        return e.discover({data: {command: "schemaKPIs", restrictions: {catalogName: e.transport.catalog(), cubeName: e.transport.cube()}}}, function(t) {
          return e.reader.kpis(t)
        })
      }, schemaDimensions: function() {
        var e = this;
        return e.discover({data: {command: "schemaDimensions", restrictions: {catalogName: e.transport.catalog(), cubeName: e.transport.cube()}}}, function(t) {
          return e.reader.dimensions(t)
        })
      }, schemaHierarchies: function(e) {
        var t = this;
        return t.discover({data: {command: "schemaHierarchies", restrictions: {catalogName: t.transport.catalog(), cubeName: t.transport.cube(), dimensionUniqueName: e}}}, function(e) {
          return t.reader.hierarchies(e)
        })
      }, schemaLevels: function(e) {
        var t = this;
        return t.discover({data: {command: "schemaLevels", restrictions: {catalogName: t.transport.catalog(), cubeName: t.transport.cube(), hierarchyUniqueName: e}}}, function(e) {
          return t.reader.levels(e)
        })
      }, schemaCubes: function() {
        var e = this;
        return e.discover({data: {command: "schemaCubes", restrictions: {catalogName: e.transport.catalog()}}}, function(t) {
          return e.reader.cubes(t)
        })
      }, schemaCatalogs: function() {
        var e = this;
        return e.discover({data: {command: "schemaCatalogs"}}, function(t) {
          return e.reader.catalogs(t)
        })
      }, schemaMembers: function(e) {
        var t = this, n = function(e) {
          return function(n) {
            return t.reader.members(n, e)
          }
        }(e);
        return t.discover({data: {command: "schemaMembers", restrictions: we({catalogName: t.transport.catalog(), cubeName: t.transport.cube()}, e)}}, n)
      }, _params: function(e) {
        this._clearAxesData && (this._axes = {}, this._data = this._observe([]), this._clearAxesData = !1, this.trigger(Ie));
        var t = xe.fn._params.call(this, e);
        return t = we({measures: this.measures(), measuresAxis: this.measuresAxis(), columns: this.columns(), rows: this.rows()}, t), this.cubeBuilder && (this._requestData = t), t
      }});
    je.create = function(e) {
      e = e && e.push ? {data: e} : e;
      var t = e || {}, n = t.data;
      if (t.data = n, !(t instanceof je) && t instanceof he.data.DataSource)
        throw Error("Incorrect DataSource type. Only PivotDataSource instances are supported");
      return t instanceof je ? t : new je(t)
    }, K = {contains: ', InStr({0}.CurrentMember.MEMBER_CAPTION,"{1}") > 0', doesnotcontain: ', InStr({0}.CurrentMember.MEMBER_CAPTION,"{1}") = 0', startswith: ', Left({0}.CurrentMember.MEMBER_CAPTION,Len("{1}"))="{1}"', endswith: ', Right({0}.CurrentMember.MEMBER_CAPTION,Len("{1}"))="{1}"', eq: ', {0}.CurrentMember.MEMBER_CAPTION = "{1}"', neq: ', NOT {0}.CurrentMember.MEMBER_CAPTION = "{1}"'}, Y = {schemaCubes: "MDSCHEMA_CUBES", schemaCatalogs: "DBSCHEMA_CATALOGS", schemaMeasures: "MDSCHEMA_MEASURES", schemaDimensions: "MDSCHEMA_DIMENSIONS", schemaHierarchies: "MDSCHEMA_HIERARCHIES", schemaLevels: "MDSCHEMA_LEVELS", schemaMembers: "MDSCHEMA_MEMBERS", schemaKPIs: "MDSCHEMA_KPIS"}, Q = {read: function(e) {
        var t, n, r, i, s, o = '<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement>';
        return o += "SELECT NON EMPTY {", t = e.columns || [], n = e.rows || [], r = e.measures || [], i = "rows" === e.measuresAxis, s = e.sort || [], !t.length && n.length && (!r.length || r.length && i) && (t = n, n = [], i = !1), t.length || n.length || (i = !1), t.length ? o += $(t, i ? [] : r, s) : r.length && !i && (o += L(r).join(",")), o += "} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON COLUMNS", (n.length || i && r.length > 1) && (o += ", NON EMPTY {", o += n.length ? $(n, i ? r : [], s) : L(r).join(","), o += "} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON ROWS"), e.filter ? (o += " FROM ", o += "(", o += W(e.filter, e.connection.cube), o += ")") : o += " FROM [" + e.connection.cube + "]", 1 == r.length && t.length && (o += " WHERE (" + L(r).join(",") + ")"), o += "</Statement></Command><Properties><PropertyList><Catalog>" + e.connection.catalog + "</Catalog><Format>Multidimensional</Format></PropertyList></Properties></Execute></Body></Envelope>", o.replace(/\&/g, "&amp;")
      }, discover: function(t) {
        t = t || {};
        var n = '<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis">';
        return n += "<RequestType>" + (Y[t.command] || t.command) + "</RequestType>", n += "<Restrictions>" + V("RestrictionList", t.restrictions, !0) + "</Restrictions>", t.connection && t.connection.catalog && (t.properties = e.extend({}, {Catalog: t.connection.catalog}, t.properties)), n += "<Properties>" + V("PropertyList", t.properties) + "</Properties>", n += "</Discover></Body></Envelope>"
      }}, X = he.data.RemoteTransport.extend({init: function(e) {
        var t = e;
        e = this.options = we(!0, {}, this.options, e), he.data.RemoteTransport.call(this, e), ye(t.discover) ? this.discover = t.discover : "string" == typeof t.discover ? this.options.discover = {url: t.discover} : t.discover || (this.options.discover = this.options.read)
      }, setup: function(t, n) {
        return t.data = t.data || {}, e.extend(!0, t.data, {connection: this.options.connection}), he.data.RemoteTransport.fn.setup.call(this, t, n)
      }, options: {read: {dataType: "text", contentType: "text/xml", type: "POST"}, discover: {dataType: "text", contentType: "text/xml", type: "POST"}, parameterMap: function(e, t) {
          return Q[t](e, t)
        }}, discover: function(t) {
        return e.ajax(this.setup(t, "discover"))
      }}), J = {cubes: {name: he.getter("CUBE_NAME['#text']", !0), caption: he.getter("CUBE_CAPTION['#text']", !0), description: he.getter("DESCRIPTION['#text']", !0), type: he.getter("CUBE_TYPE['#text']", !0)}, catalogs: {name: he.getter("CATALOG_NAME['#text']", !0), description: he.getter("DESCRIPTION['#text']", !0)}, measures: {name: he.getter("MEASURE_NAME['#text']", !0), caption: he.getter("MEASURE_CAPTION['#text']", !0), uniqueName: he.getter("MEASURE_UNIQUE_NAME['#text']", !0), description: he.getter("DESCRIPTION['#text']", !0), aggregator: he.getter("MEASURE_AGGREGATOR['#text']", !0), groupName: he.getter("MEASUREGROUP_NAME['#text']", !0), displayFolder: he.getter("MEASURE_DISPLAY_FOLDER['#text']", !0), defaultFormat: he.getter("DEFAULT_FORMAT_STRING['#text']", !0)}, kpis: {name: he.getter("KPI_NAME['#text']", !0), caption: he.getter("KPI_CAPTION['#text']", !0), value: he.getter("KPI_VALUE['#text']", !0), goal: he.getter("KPI_GOAL['#text']", !0), status: he.getter("KPI_STATUS['#text']", !0), trend: he.getter("KPI_TREND['#text']", !0), statusGraphic: he.getter("KPI_STATUS_GRAPHIC['#text']", !0), trendGraphic: he.getter("KPI_TREND_GRAPHIC['#text']", !0), description: he.getter("KPI_DESCRIPTION['#text']", !0), groupName: he.getter("MEASUREGROUP_NAME['#text']", !0)}, dimensions: {name: he.getter("DIMENSION_NAME['#text']", !0), caption: he.getter("DIMENSION_CAPTION['#text']", !0), description: he.getter("DESCRIPTION['#text']", !0), uniqueName: he.getter("DIMENSION_UNIQUE_NAME['#text']", !0), defaultHierarchy: he.getter("DEFAULT_HIERARCHY['#text']", !0), type: he.getter("DIMENSION_TYPE['#text']", !0)}, hierarchies: {name: he.getter("HIERARCHY_NAME['#text']", !0), caption: he.getter("HIERARCHY_CAPTION['#text']", !0), description: he.getter("DESCRIPTION['#text']", !0), uniqueName: he.getter("HIERARCHY_UNIQUE_NAME['#text']", !0), dimensionUniqueName: he.getter("DIMENSION_UNIQUE_NAME['#text']", !0), displayFolder: he.getter("HIERARCHY_DISPLAY_FOLDER['#text']", !0), origin: he.getter("HIERARCHY_ORIGIN['#text']", !0), defaultMember: he.getter("DEFAULT_MEMBER['#text']", !0)}, levels: {name: he.getter("LEVEL_NAME['#text']", !0), caption: he.getter("LEVEL_CAPTION['#text']", !0), description: he.getter("DESCRIPTION['#text']", !0), uniqueName: he.getter("LEVEL_UNIQUE_NAME['#text']", !0), dimensionUniqueName: he.getter("DIMENSION_UNIQUE_NAME['#text']", !0), displayFolder: he.getter("LEVEL_DISPLAY_FOLDER['#text']", !0), orderingProperty: he.getter("LEVEL_ORDERING_PROPERTY['#text']", !0), origin: he.getter("LEVEL_ORIGIN['#text']", !0), hierarchyUniqueName: he.getter("HIERARCHY_UNIQUE_NAME['#text']", !0)}, members: {name: he.getter("MEMBER_NAME['#text']", !0), caption: he.getter("MEMBER_CAPTION['#text']", !0), uniqueName: he.getter("MEMBER_UNIQUE_NAME['#text']", !0), dimensionUniqueName: he.getter("DIMENSION_UNIQUE_NAME['#text']", !0), hierarchyUniqueName: he.getter("HIERARCHY_UNIQUE_NAME['#text']", !0), levelUniqueName: he.getter("LEVEL_UNIQUE_NAME['#text']", !0), childrenCardinality: he.getter("CHILDREN_CARDINALITY['#text']", !0)}}, Z = ["axes", "catalogs", "cubes", "dimensions", "hierarchies", "levels", "measures"], ee = he.data.XmlDataReader.extend({init: function(e) {
        he.data.XmlDataReader.call(this, e), this._extend(e)
      }, _extend: function(e) {
        for (var t, n, r = 0, i = Z.length; i > r; r++)
          t = Z[r], n = e[t], n && n !== _e && (this[t] = n)
      }, parse: function(e) {
        var t = he.data.XmlDataReader.fn.parse(e.replace(/<(\/?)(\w|-)+:/g, "<$1"));
        return he.getter("['Envelope']['Body']", !0)(t)
      }, errors: function(e) {
        var t = he.getter("['Fault']", !0)(e);
        return t ? [{faultstring: he.getter("faultstring['#text']", !0)(t), faultcode: he.getter("faultcode['#text']", !0)(t)}] : null
      }, axes: function(e) {
        var t, n, r, i;
        for (e = he.getter('ExecuteResponse["return"].root', !0)(e), t = j(he.getter("Axes.Axis", !0)(e)), r = {columns:{}, rows:{}}, i = 0; t.length > i; i++)
          n = t[i], "sliceraxis" !== n["@name"].toLowerCase() && (r.columns.tuples ? r.rows = G(n) : r.columns = G(n));
        return r
      }, data: function(e) {
        var t, n, r, i, s, o;
        for (e = he.getter('ExecuteResponse["return"].root', !0)(e), t = j(he.getter("CellData.Cell", !0)(e)), n = [], r = he.getter("['@CellOrdinal']"), i = he.getter("Value['#text']"), s = he.getter("FmtValue['#text']"), o = 0; t.length > o; o++)
          n.push({value: i(t[o]), fmtValue: s(t[o]), ordinal: parseInt(r(t[o]), 10)});
        return n
      }, _mapSchema: function(e, t) {
        var n, r, i, s, o;
        for (e = he.getter('DiscoverResponse["return"].root', !0)(e), n = j(he.getter("row", !0)(e)), r = [], i = 0; n.length > i; i++) {
          s = {};
          for (o in t)
            s[o] = t[o](n[i]);
          r.push(s)
        }
        return r
      }, measures: function(e) {
        return this._mapSchema(e, J.measures)
      }, kpis: function(e) {
        return this._mapSchema(e, J.kpis)
      }, hierarchies: function(e) {
        return this._mapSchema(e, J.hierarchies)
      }, levels: function(e) {
        return this._mapSchema(e, J.levels)
      }, dimensions: function(e) {
        return this._mapSchema(e, J.dimensions)
      }, cubes: function(e) {
        return this._mapSchema(e, J.cubes)
      }, catalogs: function(e) {
        return this._mapSchema(e, J.catalogs)
      }, members: function(e) {
        return this._mapSchema(e, J.members)
      }}), we(!0, he.data, {PivotDataSource: je, XmlaTransport: X, XmlaDataReader: ee, PivotCubeBuilder: We, transports: {xmla: X}, readers: {xmla: ee}}), te = function(e, t) {
      if (!e)
        return null;
      for (var n = 0, r = e.length; r > n; n++)
        if (e[n].field === t)
          return e[n];
      return null
    }, ne = function(e, t) {
      var n, r, i = [];
      for (n = 0, r = e.length; r > n; n++)
        e[n].field !== t && i.push(e[n]);
      return i
    }, he.ui.PivotSettingTarget = ge.extend({init: function(t, n) {
        var r = this;
        ge.fn.init.call(r, t, n), r.element.addClass("k-pivot-setting"), r.dataSource = he.data.PivotDataSource.create(n.dataSource), r._refreshHandler = e.proxy(r.refresh, r), r.dataSource.first(ke, r._refreshHandler), n.template || (r.options.template = "<div data-" + he.ns + 'name="${data.name || data}">${data.name || data}' + (r.options.enabled ? '<a class="k-button k-button-icon k-button-bare"><span class="k-icon k-setting-delete"></span></a>' : "") + "</div>"), r.template = he.template(r.options.template), r.emptyTemplate = he.template(r.options.emptyTemplate), r._sortable(), r.element.on("click" + Ae, ".k-button,.k-item", function(t) {
          var n = e(t.target), i = n.closest("[" + he.attr("name") + "]").attr(he.attr("name"));
          i && (n.hasClass("k-setting-delete") ? r.remove(i) : r.options.sortable && n[0] === t.currentTarget && r.sort({field: i, dir: n.find(".k-i-sort-asc")[0] ? "desc" : "asc"}))
        }), (n.filterable || n.sortable) && (r.fieldMenu = new pe.PivotFieldMenu(r.element, {messages: r.options.messages.fieldMenu, filter: ".k-setting-fieldmenu", filterable: n.filterable, sortable: n.sortable, dataSource: r.dataSource})), r.refresh()
      }, options: {name: "PivotSettingTarget", template: null, filterable: !1, sortable: !1, emptyTemplate: "<div class='k-empty'>${data}</div>", setting: "columns", enabled: !0, messages: {empty: "Drop Fields Here"}}, setDataSource: function(e) {
        this.dataSource.unbind(ke, this._refreshHandler), this.dataSource = this.options.dataSource = e, this.fieldMenu && this.fieldMenu.setDataSource(e), e.first(ke, this._refreshHandler), this.refresh()
      }, _sortable: function() {
        var e = this;
        e.options.enabled && (this.sortable = this.element.kendoSortable({connectWith: this.options.connectWith, filter: ">:not(.k-empty)", hint: e.options.hint, cursor: "move", start: function(e) {
            e.item.focus().blur()
          }, change: function(t) {
            var n = t.item.attr(he.attr("name"));
            "receive" == t.action ? e.add(n) : "remove" == t.action ? e.remove(n) : "sort" == t.action && e.move(n, t.newIndex)
          }}).data("kendoSortable"))
      }, _indexOf: function(e, t) {
        var n, r, i = -1;
        for (n = 0, r = t.length; r > n; n++)
          if (O(t[n]) === e) {
            i = n;
            break
          }
        return i
      }, _isKPI: function(e) {
        return"kpi" === e.type || e.measure
      }, validate: function(e) {
        var t, n, r = 2 == e.type || "aggregator"in e || this._isKPI(e);
        return r ? "measures" === this.options.setting : "measures" === this.options.setting ? r : (t = this.dataSource[this.options.setting](), n = e.defaultHierarchy || e.uniqueName, this._indexOf(n, t) > -1 ? !1 : (t = this.dataSource["columns" === this.options.setting ? "rows" : "columns"](), this._indexOf(n, t) > -1 ? !1 : !0))
      }, add: function(t) {
        var n, r, i = this.dataSource[this.options.setting]();
        for (t = e.isArray(t)?t.slice(0):[t], n = 0, r = t.length; r > n; n++)
          -1 !== this._indexOf(t[n], i) && (t.splice(n, 1), n -= 1, r -= 1);
        t.length && (i = i.concat(t), this.dataSource[this.options.setting](i))
      }, move: function(e, t) {
        var n = this.dataSource[this.options.setting](), r = this._indexOf(e, n);
        r > -1 && (e = n.splice(r, 1)[0], n.splice(t, 0, e), this.dataSource[this.options.setting](n))
      }, remove: function(e) {
        var t = this.dataSource[this.options.setting](), n = this._indexOf(e, t);
        n > -1 && (t.splice(n, 1), this.dataSource[this.options.setting](t))
      }, sort: function(e) {
        var t = this.options.sortable, n = t === !0 || t.allowUnsort, r = n && "asc" === e.dir, i = this.dataSource.sort() || [], s = ne(i, e.field);
        r && i.length !== s.length && (e = null), e && s.push(e), this.dataSource.sort(s)
      }, refresh: function() {
        var e, n = "", r = this.dataSource[this.options.setting](), i = r.length, s = 0;
        if (i)
          for (; i > s; s++)
            e = r[s], e = e.name === t ? {name: e} : e, n += this.template(we({sortIcon: this._sortIcon(e.name)}, e));
        else
          n = this.emptyTemplate(this.options.messages.empty);
        this.element.html(n)
      }, destroy: function() {
        ge.fn.destroy.call(this), this.dataSource.unbind(ke, this._refreshHandler), this.element.off(Ae), this.sortable && this.sortable.destroy(), this.fieldMenu && this.fieldMenu.destroy(), this.element = null, this._refreshHandler = null
      }, _sortIcon: function(e) {
        var t = this.dataSource.sort(), n = te(t, O(e)), r = "";
        return n && (r = "k-i-sort-" + n.dir), r
      }}), re = ge.extend({init: function(n, r) {
        var i, s, o = this;
        ge.fn.init.call(o, n, r), o._dataSource(), o._bindConfigurator(), o._wrapper(), o._createLayout(), o._columnBuilder = i = new de, o._rowBuilder = s = new ue, o._contentBuilder = new ce, o._templates(), o.columnsHeader.add(o.rowsHeader).on("click", "span.k-icon", function() {
          var n, r, a, l, d = e(this), u = i, c = "expandColumn", m = d.attr(he.attr("path")), h = {axis: "columns", path: e.parseJSON(m)};
          d.parent().is("td") && (u = s, c = "expandRow", h.axis = "rows"), r = d.hasClass(Fe), a = u.metadata[m], l = a.expanded === t, n = r ? Pe : He, h.childrenLoaded = a.maxChildren > a.children, o.trigger(n, h) || (u.metadata[m].expanded = !r, d.toggleClass(Fe, !r).toggleClass(Le, r), !r && l ? o.dataSource[c](h.path) : o.refresh())
        }), o._scrollable(), o.options.autoBind && o.dataSource.fetch(), he.notify(o)
      }, events: [Me, De, He, Pe], options: {name: "PivotGrid", autoBind: !0, reorderable: !0, filterable: !1, sortable: !1, height: null, columnWidth: 100, configurator: "", columnHeaderTemplate: null, rowHeaderTemplate: null, dataCellTemplate: null, kpiStatusTemplate: null, kpiTrendTemplate: null, messages: {measureFields: "Drop Data Fields Here", columnFields: "Drop Column Fields Here", rowFields: "Drop Rows Fields Here"}}, _templates: function() {
        var e = this.options.columnHeaderTemplate, t = this.options.rowHeaderTemplate, n = this.options.dataCellTemplate, r = this.options.kpiStatusTemplate, i = this.options.kpiTrendTemplate;
        this._columnBuilder.template = he.template(e || Oe, {useWithBlock: !!e}), this._contentBuilder.dataTemplate = he.template(n || Be, {useWithBlock: !!n}), this._contentBuilder.kpiStatusTemplate = he.template(r || ze, {useWithBlock: !!r}), this._contentBuilder.kpiTrendTemplate = he.template(i || Ue, {useWithBlock: !!i}), this._rowBuilder.template = he.template(t || Oe, {useWithBlock: !!t})
      }, _bindConfigurator: function() {
        var t = this.options.configurator;
        t && e(t).kendoPivotConfigurator("setDataSource", this.dataSource)
      }, cellInfoByElement: function(t) {
        return t = e(t), this.cellInfo(t.index(), t.parent("tr").index())
      }, cellInfo: function(e, t) {
        var n, r = this._contentBuilder, i = r.columnIndexes[e || 0], s = r.rowIndexes[t || 0];
        return i && s ? (n = s.index * r.rowLength + i.index, {columnTuple: i.tuple, rowTuple: s.tuple, measure: i.measure || s.measure, dataItem: this.dataSource.view()[n]}) : null
      }, setDataSource: function(e) {
        this.options.dataSource = e, this._dataSource(), this.measuresTarget && this.measuresTarget.setDataSource(e), this.rowsTarget && this.rowsTarget.setDataSource(e), this.columnsTarget && this.columnsTarget.setDataSource(e), this._bindConfigurator(), this.options.autoBind && e.fetch()
      }, setOptions: function(e) {
        ge.fn.setOptions.call(this, e), this._templates()
      }, destroy: function() {
        ge.fn.destroy.call(this), clearTimeout(this._headerReflowTimeout)
      }, _dataSource: function() {
        var t = this, n = t.options.dataSource;
        n = e.isArray(n) ? {data: n} : n, t.dataSource && this._refreshHandler ? t.dataSource.unbind(ke, t._refreshHandler).unbind(Ie, t._stateResetHandler).unbind(Ce, t._progressHandler).unbind(Se, t._errorHandler) : (t._refreshHandler = e.proxy(t.refresh, t), t._progressHandler = e.proxy(t._requestStart, t), t._stateResetHandler = e.proxy(t._stateReset, t), t._errorHandler = e.proxy(t._error, t)), t.dataSource = he.data.PivotDataSource.create(n).bind(ke, t._refreshHandler).bind(Ce, t._progressHandler).bind(Ie, t._stateResetHandler).bind(Se, t._errorHandler)
      }, _error: function() {
        this._progress(!1)
      }, _requestStart: function() {
        this._progress(!0)
      }, _stateReset: function() {
        this._columnBuilder.reset(), this._rowBuilder.reset()
      }, _wrapper: function() {
        var e = this.options.height;
        this.wrapper = this.element.addClass("k-widget k-pivot"), e && this.wrapper.css("height", e)
      }, _measureFields: function() {
        this.measureFields = e(Ee).addClass("k-pivot-toolbar k-header k-settings-measures"), this.measuresTarget = this._createSettingTarget(this.measureFields, {setting: "measures", messages: {empty: this.options.messages.measureFields}})
      }, _createSettingTarget: function(t, n) {
        var r = '<span tabindex="0" class="k-button" data-' + he.ns + 'name="${data.name}">${data.name}', i = n.sortable, s = "";
        return i && (s += "#if (data.sortIcon) {#", s += '<span class="k-icon ${data.sortIcon} k-setting-sort"></span>', s += "#}#"), (n.filterable || i) && (s += '<span class="k-icon k-i-arrowhead-s k-setting-fieldmenu"></span>'), this.options.reorderable && (s += '<span class="k-icon k-si-close k-setting-delete"></span>'), s && (r += '<span class="k-field-actions">' + s + "</span>"), r += "</span>", new he.ui.PivotSettingTarget(t, e.extend({template: r, emptyTemplate: '<span class="k-empty">${data}</span>', enabled: this.options.reorderable, dataSource: this.dataSource}, n))
      }, _initSettingTargets: function() {
        this.columnsTarget = this._createSettingTarget(this.columnFields, {connectWith: this.rowFields, setting: "columns", filterable: this.options.filterable, sortable: this.options.sortable, messages: {empty: this.options.messages.columnFields, fieldMenu: this.options.messages.fieldMenu}}), this.rowsTarget = this._createSettingTarget(this.rowFields, {connectWith: this.columnFields, setting: "rows", filterable: this.options.filterable, sortable: this.options.sortable, messages: {empty: this.options.messages.rowFields, fieldMenu: this.options.messages.fieldMenu}})
      }, _createLayout: function() {
        var t = this, n = e($e), r = n.find(".k-pivot-rowheaders"), i = n.find(".k-pivot-table"), s = e(Ee).addClass("k-grid k-widget");
        t._measureFields(), t.columnFields = e(Ee).addClass("k-pivot-toolbar k-header k-settings-columns"), t.rowFields = e(Ee).addClass("k-pivot-toolbar k-header k-settings-rows"), t.columnsHeader = e('<div class="k-grid-header-wrap" />').wrap('<div class="k-grid-header" />'), t.columnsHeader.parent().css("padding-right", he.support.scrollbar()), t.rowsHeader = e('<div class="k-grid k-widget k-alt"/>'), t.content = e('<div class="k-grid-content" />'), r.append(t.measureFields), r.append(t.rowFields), r.append(t.rowsHeader), s.append(t.columnsHeader.parent()), s.append(t.content), i.append(t.columnFields), i.append(s), t.wrapper.append(n), t.columnsHeaderTree = new he.dom.Tree(t.columnsHeader[0]), t.rowsHeaderTree = new he.dom.Tree(t.rowsHeader[0]), t.contentTree = new he.dom.Tree(t.content[0]), t._initSettingTargets()
      }, _progress: function(e) {
        he.ui.progress(this.wrapper, e)
      }, _resize: function() {
        this.content[0].firstChild && (this._setSectionsWidth(), this._setSectionsHeight(), this._setContentWidth(), this._setContentHeight(), this._columnHeaderReflow())
      }, _columnHeaderReflow: function() {
        var e = this.columnsHeader.children("table");
        he.support.browser.mozilla && (clearTimeout(this._headerReflowTimeout), e.css("table-layout", "auto"), this._headerReflowTimeout = setTimeout(function() {
          e.css("table-layout", "")
        }))
      }, _setSectionsWidth: function() {
        var e = this.rowsHeader, t = e.parent(".k-pivot-rowheaders").width(Ne), n = Math.max(this.measureFields.outerWidth(), this.rowFields.outerWidth());
        n = Math.max(e.children("table").width(), n), t.width(n)
      }, _setSectionsHeight: function() {
        var e = this.measureFields.height(Ne).height(), t = this.columnFields.height(Ne).height(), n = this.rowFields.height(Ne).innerHeight(), r = this.columnsHeader.height(Ne).innerHeight(), i = n - this.rowFields.height(), s = t > e ? t : e, o = r > n ? r : n;
        this.measureFields.height(s), this.columnFields.height(s), this.rowFields.height(o - i), this.columnsHeader.height(o)
      }, _setContentWidth: function() {
        var e = this.content.find("table"), t = this.columnsHeader.children("table"), n = e.children("colgroup").children().length, r = n * this.options.columnWidth, i = Math.ceil(r / this.content.width() * 100);
        100 > i && (i = 100), e.add(t).css("width", i + "%"), this._resetColspan(t)
      }, _setContentHeight: function() {
        var e = this, n = e.content, r = e.rowsHeader, i = e.wrapper.innerHeight(), s = he.support.scrollbar(), o = n[0].offsetHeight === n[0].clientHeight, a = e.options.height;
        if (e.wrapper.is(":visible")) {
          if (!i || !a)
            return o && (s = 0), n.height("auto"), r.height(n.height() - s), t;
          i -= e.columnFields.outerHeight(), i -= e.columnsHeader.outerHeight(), 2 * s >= i && (i = 2 * s + 1, o || (i += s)), n.height(i), o && (s = 0), r.height(i - s)
        }
      }, _resetColspan: function(e) {
        var n = this, r = e.children("tbody").children(":first").children(":first");
        n._colspan === t && (n._colspan = r.attr("colspan")), r.attr("colspan", 1), clearTimeout(n._layoutTimeout), n._layoutTimeout = setTimeout(function() {
          r.attr("colspan", n._colspan), n._colspan = t
        })
      }, _axisMeasures: function(e) {
        var t = [], n = this.dataSource, r = n.measures(), i = r.length > 1 || r[0] && r[0].type;
        return n.measuresAxis() === e && (0 === n[e]().length || i) && (t = r), t
      }, items: function() {
        return[]
      }, refresh: function() {
        var e, t = this, n = t.dataSource, r = n.axes(), i = (r.columns || {}).tuples || [], s = (r.rows || {}).tuples || [], o = t._columnBuilder, a = t._rowBuilder, l = {}, d = {};
        t.trigger(Me, {action: "rebind"}) || (o.measures = t._axisMeasures("columns"), t.columnsHeaderTree.render(o.build(i)), t.rowsHeaderTree.render(a.build(s)), l = {indexes: o._indexes, measures: o.measures, metadata: o.metadata}, d = {indexes: a._indexes, measures: this._axisMeasures("rows"), metadata: a.metadata}, t.contentTree.render(t._contentBuilder.build(n.view(), l, d)), t._resize(), t.touchScroller ? t.touchScroller.contentResized() : (e = he.touchScroller(t.content), e && e.movable && (t.touchScroller = e, e.movable.bind("change", function(e) {
          t.columnsHeader.scrollLeft(-e.sender.x), t.rowsHeader.scrollTop(-e.sender.y)
        }))), t._progress(!1), t.trigger(De))
      }, _scrollable: function() {
        var t = this, n = t.columnsHeader, r = t.rowsHeader;
        t.content.scroll(function() {
          n.scrollLeft(this.scrollLeft), r.scrollTop(this.scrollTop)
        }), r.bind("DOMMouseScroll" + Ae + " mousewheel" + Ae, e.proxy(t._wheelScroll, t))
      }, _wheelScroll: function(t) {
        var n, r;
        t.ctrlKey || (n = he.wheelDeltaY(t), r = this.content.scrollTop(), n && (t.preventDefault(), e(t.currentTarget).one("wheel" + Ae, !1), this.rowsHeader.scrollTop(r + -n), this.content.scrollTop(r + -n)))
      }}), ie = he.dom.element, se = he.dom.html, oe = function(e, t) {
      return{maxChildren: 0, children: 0, maxMembers: 0, members: 0, measures: 1, levelNum: e, parentMember: 0 !== t}
    }, ae = function(e, t) {
      for (var n = [], r = 0; t >= r; r++)
        n.push(e.members[r].name);
      return n
    }, le = function(e, t) {
      for (var n = "", r = 0; t >= r; r++)
        n += e.members[r].name;
      return n
    }, de = fe.extend({init: function() {
        this.measures = 1, this.metadata = {}
      }, build: function(e) {
        var t = this._tbody(e), n = this._colGroup();
        return[ie("table", null, [n, t])]
      }, reset: function() {
        this.metadata = {}
      }, _colGroup: function() {
        for (var e = this._rowLength(), t = [], n = 0; e > n; n++)
          t.push(ie("col", null));
        return ie("colgroup", null, t)
      }, _tbody: function(e) {
        var t = e[0];
        return this.map = {}, this.rows = [], this.rootTuple = t, this._indexes = [], t ? (this._buildRows(t, 0), this._normalize()) : this.rows.push(ie("tr", null, [ie("th", null, [se("&nbsp;")])])), ie("tbody", null, this.rows)
      }, _normalize: function() {
        for (var e, t, n, r, i, s = this.rows, o = s.length, a = 0; o > a; a++)
          if (e = s[a], 1 !== e.rowSpan)
            for (r = e.children, n = 0, t = r.length; t > n; n++)
              i = r[n], i.tupleAll && (i.attr.rowSpan = e.rowSpan)
      }, _rowIndex: function(e) {
        for (var t = this.rows, n = t.length, r = 0; n > r && t[r] !== e; r++)
          ;
        return r
      }, _rowLength: function() {
        var e = this.rows[0] ? this.rows[0].children : [], t = e.length, n = 0, r = 0;
        if (t)
          for (; t > r; r++)
            n += e[r].attr.colSpan || 1;
        return n || (n = this.measures), n
      }, _row: function(e, t, n) {
        var r, i, s = this.rootTuple.members[t].name, o = e.members[t].levelNum, a = s + o, l = this.map, d = l[a];
        return d ? (d.notFirst = !1, d.parentMember && d.parentMember === n || (d.parentMember = n, d.collapsed = 0, d.colSpan = 0)) : (d = ie("tr", null, []), d.parentMember = n, d.collapsed = 0, d.colSpan = 0, d.rowSpan = 1, l[a] = d, r = l[s + (+o - 1)], r && (i = r.children, d.notFirst = i[1] && -1 === i[1].attr.className.indexOf("k-alt") ? !0 : r.notFirst), this.rows.splice(this._rowIndex(r) + 1, 0, d)), d
      }, _measures: function(e, t, n) {
        var r, i, s, o = this.map, a = o.measureRow;
        for (a || (a = ie("tr", null, []), o.measureRow = a, this.rows.push(a)), i = 0, s = e.length; s > i; i++)
          r = e[i], a.children.push(this._cell(n || "", [this._content(r, t)], r));
        return s
      }, _content: function(e, t) {
        return se(this.template({member: e, tuple: t}))
      }, _cell: function(e, t, n) {
        var r = ie("th", {className: "k-header" + e}, t);
        return r.value = n.caption || n.name, r
      }, _buildRows: function(e, n, r) {
        var i, s, o, a, l, d, u, c, m, h, p = e.members, f = p[n], g = p[n + 1], x = [], v = 0, _ = 0, b = 0;
        if (f.measure)
          return this._measures(f.children, e), t;
        if (c = he.stringify(ae(e, n)), i = this._row(e, n, r), o = f.children, a = o.length, m = this.metadata[c], m || (this.metadata[c] = m = oe(+f.levelNum, n), m.rootLevelNum = +this.rootTuple.members[n].levelNum), this._indexes.push({path: c, tuple: e}), f.hasChildren && (m.expanded === !1 && (_ = m.maxChildren, i.collapsed += _, m.children = 0, a = 0), u = {className: "k-icon " + (a ? Fe : Le)}, u[he.attr("path")] = c, x.push(ie("span", u))), x.push(this._content(f, e)), l = this._cell(i.notFirst ? " k-first" : "", x, f), i.children.push(l), i.colSpan += 1, a) {
          for (d = this._cell(" k-alt", [this._content(f, e)], f), i.children.push(d); a > v; v++)
            s = this._buildRows(o[v], n, f);
          h = s.colSpan, _ = s.collapsed, l.attr.colSpan = h, m.children = h, m.members = 1, i.colSpan += h, i.collapsed += _, i.rowSpan = s.rowSpan + 1, g && (g.measure ? h = this._measures(g.children, e, " k-alt") : (s = this._buildRows(e, n + 1), h = s.colSpan, i.collapsed += s.collapsed, b = s.collapsed), d.attr.colSpan = h, h -= 1, m.members += h, i.colSpan += h)
        } else
          g && (g.measure ? h = this._measures(g.children, e) : (s = this._buildRows(e, n + 1), h = s.colSpan, i.collapsed += s.collapsed, b = s.collapsed), m.members = h, h > 1 && (l.attr.colSpan = h, i.colSpan += h - 1));
        return m.members + b > m.maxMembers && (m.maxMembers = m.members + b), o = m.children + _, o > m.maxChildren && (m.maxChildren = o), (d || l).tupleAll = !0, i
      }}), ue = fe.extend({init: function() {
        this.metadata = {}
      }, build: function(e) {
        var t = this._tbody(e), n = this._colGroup();
        return[ie("table", null, [n, t])]
      }, reset: function() {
        this.metadata = {}
      }, _rowLength: function() {
        for (var e = this.rows[0].children, t = 0, n = 0, r = e[n]; r; )
          t += r.attr.colSpan || 1, r = e[++n];
        return t
      }, _colGroup: function() {
        for (var e = this._rowLength(), t = [], n = 0; e > n; n++)
          t.push(ie("col", null));
        return ie("colgroup", null, t)
      }, _tbody: function(e) {
        var t = e[0];
        return this.rootTuple = t, this.rows = [], this.map = {}, this._indexes = [], t ? (this._buildRows(t, 0), this._normalize()) : this.rows.push(ie("tr", null, [ie("td", null, [se("&nbsp;")])])), ie("tbody", null, this.rows)
      }, _normalize: function() {
        for (var e, t, n, r, i = this.rows, s = i.length, o = 0, a = this.rootTuple.members, l = a[0].name, d = a.length, u = 0, c = this.map; s > o; o++)
          for (e = i[o], u = 0; d > u; u++)
            n = this[a[u].name], t = e.colSpan["dim" + u], t && n > t.colSpan && (t.attr.colSpan = n - t.colSpan + 1);
        e = c[l], r = c[l + "all"], e && (e.children[0].attr.className = "k-first"), r && (r.children[0].attr.className += " k-first")
      }, _row: function(e) {
        var t = ie("tr", null, e);
        return t.rowSpan = 1, t.colSpan = {}, this.rows.push(t), t
      }, _content: function(e, t) {
        return se(this.template({member: e, tuple: t}))
      }, _cell: function(e, t, n) {
        var r = ie("td", {className: e}, t);
        return r.value = n.caption || n.name, r
      }, _buildRows: function(e, t) {
        var n, r, i, s, o, a, l, d, u, c = this.map, m = e.members, h = m[t], p = m[t + 1], f = h.children, g = f.length, x = +h.levelNum, v = this.rootTuple.members[t].name, _ = ae(e, t - 1).join(""), b = +this.rootTuple.members[t].levelNum, w = _ + (b === x ? "" : h.parentName || ""), y = c[w + "all"] || c[w], k = x + 1, S = [];
        if (!y || y.hasChild ? y = this._row() : y.hasChild = !0, h.measure) {
          for (l = y.allCell?"k-grid-footer":"", y.children.push(this._cell(l, [this._content(f[0], e)], f[0])), y.rowSpan = g, u = 1; g > u; u++)
            this._row([this._cell(l, [this._content(f[u], e)], f[u])]);
          return y
        }
        if (c[_ + h.name] = y, n = he.stringify(ae(e, t)), a = this.metadata[n], a || (this.metadata[n] = a = oe(x, t), a.rootLevelNum = b), this._indexes.push({path: n, tuple: e}), h.hasChildren && (a.expanded === !1 && (g = 0, a.children = 0), d = {className: "k-icon " + (g ? Fe : Le)}, d[he.attr("path")] = n, S.push(ie("span", d))), S.push(this._content(h, e)), l = y.allCell && !g ? "k-grid-footer" : "", r = this._cell(l, S, h), r.colSpan = k, y.children.push(r), y.colSpan["dim" + t] = r, (!this[v] || k > this[v]) && (this[v] = k), g) {
          for (y.allCell = !1, y.hasChild = !1, u = 0; g > u; u++)
            s = this._buildRows(f[u], t), y !== s && (y.rowSpan += s.rowSpan);
          y.rowSpan > 1 && (r.attr.rowSpan = y.rowSpan), a.children = y.rowSpan, i = this._cell("k-grid-footer", [this._content(h, e)], h), i.colSpan = k, o = this._row([i]), o.colSpan["dim" + t] = i, o.allCell = !0, c[_ + h.name + "all"] = o, p && (s = this._buildRows(e, t + 1), i.attr.rowSpan = s.rowSpan), y.rowSpan += o.rowSpan, a.members = o.rowSpan
        } else
          p && (y.hasChild = !1, this._buildRows(e, t + 1), (i || r).attr.rowSpan = y.rowSpan, a.members = y.rowSpan);
        return a.children > a.maxChildren && (a.maxChildren = a.children), a.members > a.maxMembers && (a.maxMembers = a.members), y
      }}), ce = fe.extend({init: function() {
        this.columnAxis = {}, this.rowAxis = {}
      }, build: function(e, n, r) {
        var i, s, o = n.indexes[0], a = n.metadata[o ? o.path : t];
        return this.columnAxis = n, this.rowAxis = r, this.data = e, this.rowLength = a ? a.maxChildren + a.maxMembers : n.measures.length || 1, this.rowLength || (this.rowLength = 1), i = this._tbody(), s = this._colGroup(), [ie("table", null, [s, i])]
      }, _colGroup: function() {
        var e = this.columnAxis.measures.length || 1, t = [], n = 0;
        for (this.rows[0] && (e = this.rows[0].children.length); e > n; n++)
          t.push(ie("col", null));
        return ie("colgroup", null, t)
      }, _tbody: function() {
        return this.rows = [], this.data[0] ? (this.columnIndexes = this._indexes(this.columnAxis, this.rowLength), this.rowIndexes = this._indexes(this.rowAxis, Math.ceil(this.data.length / this.rowLength)), this._buildRows()) : this.rows.push(ie("tr", null, [ie("td", null, [se("&nbsp;")])])), ie("tbody", null, this.rows)
      }, _indexes: function(e, n) {
        var r, i, s, o, a, l, d = [], u = e.indexes, c = e.metadata, m = e.measures, h = m.length || 1, p = 0, f = 0, g = 0, x = u.length;
        if (!x) {
          for (s = 0; h > s; s++)
            d[s] = {index: s, measure: m[s], tuple: null};
          return d
        }
        for (; x > g; g++) {
          if (r = u[g], i = c[r.path], a = i.children + i.members, l = 0, a && (a -= h), i.expanded === !1 && i.children !== i.maxChildren && (l = i.maxChildren), i.parentMember && i.levelNum === i.rootLevelNum && (a = -1), a > -1) {
            for (s = 0; h > s; s++)
              o = a + s, i.children || (o += f), d[a + f + s] = {children: a, index: p, measure: m[s], tuple: r.tuple}, p += 1;
            for (; d[f] !== t; )
              f += 1
          }
          if (f === n)
            break;
          p += l
        }
        return d
      }, _buildRows: function() {
        for (var e = this.rowIndexes, t = e.length, n = 0; t > n; n++)
          this.rows.push(this._buildRow(e[n]))
      }, _buildRow: function(e) {
        for (var t, n, r, i, s, o, a, l = e.index * this.rowLength, d = this.columnIndexes, u = d.length, c = [], m = 0; u > m; m++)
          t = d[m], s = {}, t.children && (s.className = "k-alt"), i = "", o = this.data[l + t.index], a = t.measure || e.measure, n = {columnTuple: t.tuple, rowTuple: e.tuple, measure: a, dataItem: o}, "" !== o.value && a && a.type && ("status" === a.type ? i = this.kpiStatusTemplate(n) : "trend" === a.type && (i = this.kpiTrendTemplate(n))), i || (i = this.dataTemplate(n)), r = ie("td", s, [se(i)]), r.value = o.value, c.push(r);
        return s = {}, e.children && (s.className = "k-grid-footer"), ie("tr", s, c)
      }}), pe.plugin(re), he.PivotExcelExporter = he.Class.extend({init: function(e) {
        this.options = e, this.widget = e.widget, this.dataSource = this.widget.dataSource
      }, _columns: function() {
        var e, t = this.widget.columnsHeaderTree.children[0], n = this.widget.rowsHeaderTree.children[0], r = t.children[0].children.length, i = n.children[0].children.length, s = this.widget.options.columnWidth, o = [];
        if (i && this.dataSource.data()[0])
          for (e = 0; i > e; e++)
            o.push({autoWidth: !0});
        for (e = 0; r > e; e++)
          o.push({autoWidth: !1, width: s});
        return o
      }, _cells: function(e, t, n) {
        for (var r, i, s, o, a, l = [], d = 0, u = e.length; u > d; d++) {
          for (i = [], s = e[d].children, r = s.length, o = 0; r > o; o++)
            a = s[o], i.push({ color: "#000", value: a.value, colSpan: a.attr.colSpan || 1, rowSpan: a.attr.rowSpan || 1});
          n && n(i, d), l.push({cells: i, type: t})
        }
        return l
      }, _rows: function() {
        var e, t, n = this.widget.columnsHeaderTree.children[0], r = this.widget.rowsHeaderTree.children[0], i = n.children[0].children.length, s = r.children[0].children.length, o = n.children[1].children, a = r.children[1].children, l = this.widget.contentTree.children[0].children[1].children, d = this._cells(o, "header");
        return s && d[0].cells.splice(0, 0, { color: "#000", value: "", colSpan: s, rowSpan: o.length}), e = function(e, t) {
          for (var n, r, s = 0, o = l[t].children; i > s; s++)
            n = o[s], r = +n.value, isNaN(r) && (r = n.value), e.push({ color: "#000", value: r, colSpan: 1, rowSpan: 1})
        }, t = this._cells(a, "data", e), d.concat(t)
      }, _freezePane: function() {
        var e = this.widget.columnsHeaderTree.children[0], t = this.widget.rowsHeaderTree.children[0], n = t.children[0].children.length, r = e.children[1].children;
        return{colSplit: n, rowSplit: r.length}
      }, workbook: function() {
        var t;
        return this.dataSource.view()[0] ? (t = e.Deferred(), t.resolve()) : t = this.dataSource.fetch(), t.then(e.proxy(function() {
          return{sheets: [{columns: this._columns(), rows: this._rows(), freezePane: this._freezePane(), filter: null}]}
        }, this))
      }}), me = {extend: function(t) {
        t.events.push("excelExport"), t.options.excel = e.extend(t.options.excel, this.options), t.saveAsExcel = this.saveAsExcel
      }, options: {proxyURL: "", filterable: !1, fileName: "Export.xlsx"}, saveAsExcel: function() {
        var t = this.options.excel || {}, n = new he.PivotExcelExporter({widget: this});
        n.workbook().then(e.proxy(function(e) {
          if (!this.trigger("excelExport", {workbook: e})) {
            var n = new he.ooxml.Workbook(e);
            he.saveAs({dataURI: n.toDataURL(), fileName: e.fileName || t.fileName, proxyURL: t.proxyURL, forceProxy: t.forceProxy})
          }
        }, this))
      }}, he.PivotExcelMixin = me, he.ooxml && he.ooxml.Workbook && me.extend(re.prototype), he.PDFMixin && (he.PDFMixin.extend(re.prototype), re.fn._drawPDF = function() {
      return this._drawPDFShadow({width: this.wrapper.width()}, {avoidLinks: this.options.pdf.avoidLinks})
    })
  }(window.kendo.jQuery), window.kendo
}, "function" == typeof define && define.amd ? define : function(e, t, n) {
  (n || t)()
}), function(e, t) {
  t("kendo.web.min", ["kendo.core.min", "kendo.router.min", "kendo.view.min", "kendo.fx.min", "kendo.dom.min", "kendo.data.odata.min", "kendo.data.xml.min", "kendo.data.min", "kendo.ooxml.min", "kendo.excel.min", "kendo.data.signalr.min", "kendo.binder.min", "kendo.drawing.min", "kendo.validator.min", "kendo.userevents.min", "kendo.draganddrop.min", "kendo.mobile.scroller.min", "kendo.groupable.min", "kendo.reorderable.min", "kendo.resizable.min", "kendo.sortable.min", "kendo.selectable.min", "kendo.button.min", "kendo.pager.min", "kendo.popup.min", "kendo.notification.min", "kendo.tooltip.min", "kendo.list.min", "kendo.calendar.min", "kendo.datepicker.min", "kendo.autocomplete.min", "kendo.dropdownlist.min", "kendo.combobox.min", "kendo.multiselect.min", "kendo.colorpicker.min", "kendo.columnmenu.min", "kendo.columnsorter.min", "kendo.grid.min", "kendo.listview.min", "kendo.filebrowser.min", "kendo.imagebrowser.min", "kendo.editor.min", "kendo.numerictextbox.min", "kendo.maskedtextbox.min", "kendo.menu.min", "kendo.editable.min", "kendo.pivot.fieldmenu.min", "kendo.filtercell.min", "kendo.panelbar.min", "kendo.progressbar.min", "kendo.responsivepanel.min", "kendo.tabstrip.min", "kendo.timepicker.min", "kendo.toolbar.min", "kendo.datetimepicker.min", "kendo.treeview.draganddrop.min", "kendo.treeview.min", "kendo.slider.min", "kendo.splitter.min", "kendo.upload.min", "kendo.window.min", "kendo.virtuallist.min", "kendo.scheduler.view.min", "kendo.scheduler.dayview.min", "kendo.scheduler.agendaview.min", "kendo.scheduler.monthview.min", "kendo.scheduler.recurrence.min", "kendo.scheduler.min", "kendo.gantt.list.min", "kendo.gantt.timeline.min", "kendo.gantt.min", "kendo.treelist.min", "kendo.pivotgrid.min", "kendo.spreadsheet.min", "kendo.pivot.configurator.min", "kendo.angular.min", "kendo.webcomponents.min", "kendo.angular2.min"], e)
}(function() {
  "bundle all";
  return window.kendo
}, "function" == typeof define && define.amd ? define : function(e, t, n) {
  (n || t)()
});
